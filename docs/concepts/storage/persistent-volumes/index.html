<!DOCTYPE html>
<html id="docs" lang="en" class="">
<head>
  

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-36037335-10');
</script>
<meta charset="utf-8">
<title>Persistent Volumes - SuperMap iDesktop .NET</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
<link rel="stylesheet" href="/css/base_fonts.css">
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="/css/jquery-ui.min.css">
<link rel="stylesheet" href="/css/sweetalert.min.css">
<link rel="stylesheet" href="/css/callouts.css">
<link rel="stylesheet" href="/css/custom-jekyll/tags.css">
<link rel="stylesheet" href="https://qinlj.github.io/css/main.css" />
<link rel="stylesheet" href="https://qinlj.github.io/css/share.min.css" />



<meta name="description" content="">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:url" content="https://qinlj.github.io/docs/concepts/storage/persistent-volumes/">
<meta property="og:title" content="Persistent Volumes">
<meta name="twitter:title" content="Persistent Volumes">

<meta name="twitter:image:alt"   content="SuperMap iDesktop .NET">

<meta property="og:image" content="/images/kubernetes-horizontal-color.png">

<meta property="og:type" content="article">
<script src="/js/anchor-4.1.1.min.js"></script>
<script src="/js/jquery-3.2.1.min.js"></script>
<script src="/js/jquery-ui-1.12.1.min.js"></script>
<script src="/js/bootstrap-3.3.7.min.js"></script>
<script src="/js/sweetalert-1.1.3.min.js"></script>
<script src="/js/script.js"></script>
<script src="/js/custom-jekyll/tags.js"></script>


</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            
            
            <li><a href="/docs/" class="active">Documentation</a></li>
            
            <li><a href="/blog/">Blog</a></li>
            
            <li><a href="/partners/">Partners</a></li>
            
            <li><a href="/community/">Community</a></li>
            
            <li><a href="/case-studies/">Case Studies</a></li>
            
            
            
             <li>
                <a href="#">
                    English <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="/zh/">中文 Chinese</a></li>
                
                    <li><a href="/ko/">한국어 Korean</a></li>
                
                    <li><a href="/ja/">日本語 Japanese</a></li>
                
                    <li><a href="/fr/">Français</a></li>
                
                    <li><a href="/it/">Italian</a></li>
                
                </ul>
            </li>

            <li>
                <a href="#">
                    v1.13 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="https://kubernetes.io">v1.13</a></li>
                
                    <li><a href="https://supermaphehh.github.io/zh/">iDesktop .NET</a></li>
                
                    <li><a href="https://v1-12.docs.kubernetes.io">v1.12</a></li>
                
                    <li><a href="https://v1-11.docs.kubernetes.io">v1.11</a></li>
                
                    <li><a href="https://v1-10.docs.kubernetes.io">v1.10</a></li>
                
                    <li><a href="https://v1-9.docs.kubernetes.io">v1.9</a></li>
                
                </ul>
            </li>
        </ul>

        <form id="searchBox" action="/search/">
          <input type="text" id="search" name="q" placeholder="Search" aria-label="Search">
        </form>

    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
         
           <div class="nav-box">
            <h3><a href="/docs/tutorials/hello-minikube/">Get Started</a></h3>
           <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>

        </div>
         
           <div class="nav-box">
            <h3><a href="/docs/home/">Documentation</a></h3>
           <p>Learn how to use Kubernetes with conceptual, tutorial, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>

        </div>
         
           <div class="nav-box">
            <h3><a href="/blog/">Blog</a></h3>
           <p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>

        </div>
         
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack Slack</span></a>
                <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>



<section id="hero" class="light-text no-sub">
  











<h1>Concepts</h1>
<h5></h5>










<div id="vendorStrip" class="light-text">
	<ul>
		
		
		<li><a href="/docs/home/">HOME</a></li>
		
		
		<li><a href="/docs/surfaceanalyst/">SURFACEANALYSIS</a></li>
		
		
		<li><a href="/docs/setup/">SETUP</a></li>
		
		
		<li><a href="/docs/concepts/" class="YAH">CONCEPTS</a></li>
		
		
		<li><a href="/docs/tasks/">TASKS</a></li>
		
		
		<li><a href="/docs/tutorials/">TUTORIALS</a></li>
		
		
		<li><a href="/docs/reference/">REFERENCE</a></li>
		
		
		<li><a href="/docs/contribute/">CONTRIBUTE</a></li>
		
	</ul>
	<form id="searchBox" action="/docs/search/">
		<input type="text" id="search" name="q" placeholder="Search" aria-label="Search">
  </form>
</div>

</section>



<section id="encyclopedia">
  
<div id="docsToc">
     <div class="pi-accordion">
    	
        
        
        
        
        
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
                          
                          
                 
             
         
             
         
             
         
             
         
             
         
             
         
         
        
        <a class="item" data-title="Concepts" href="/docs/concepts/"></a>

	
	
	
	
		
			
<div class="item" data-title="Overview">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="What is Kubernetes?" href="/docs/concepts/overview/what-is-kubernetes/"></a>

		
	
		
			

<a class="item" data-title="Kubernetes Components" href="/docs/concepts/overview/components/"></a>

		
	
		
			

<a class="item" data-title="The Kubernetes API" href="/docs/concepts/overview/kubernetes-api/"></a>

		
	
		
			
<div class="item" data-title="Working with Kubernetes Objects">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Understanding Kubernetes Objects" href="/docs/concepts/overview/working-with-objects/kubernetes-objects/"></a>

		
	
		
			

<a class="item" data-title="Names" href="/docs/concepts/overview/working-with-objects/names/"></a>

		
	
		
			

<a class="item" data-title="Namespaces" href="/docs/concepts/overview/working-with-objects/namespaces/"></a>

		
	
		
			

<a class="item" data-title="Labels and Selectors" href="/docs/concepts/overview/working-with-objects/labels/"></a>

		
	
		
			

<a class="item" data-title="Annotations" href="/docs/concepts/overview/working-with-objects/annotations/"></a>

		
	
		
			

<a class="item" data-title="Field Selectors" href="/docs/concepts/overview/working-with-objects/field-selectors/"></a>

		
	
		
			

<a class="item" data-title="Recommended Labels" href="/docs/concepts/overview/working-with-objects/common-labels/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Object Management Using kubectl">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Kubernetes Object Management" href="/docs/concepts/overview/object-management-kubectl/overview/"></a>

		
	
		
			

<a class="item" data-title="Managing Kubernetes Objects Using Imperative Commands" href="/docs/concepts/overview/object-management-kubectl/imperative-command/"></a>

		
	
		
			

<a class="item" data-title="Imperative Management of Kubernetes Objects Using Configuration Files" href="/docs/concepts/overview/object-management-kubectl/imperative-config/"></a>

		
	
		
			

<a class="item" data-title="Declarative Management of Kubernetes Objects Using Configuration Files" href="/docs/concepts/overview/object-management-kubectl/declarative-config/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Kubernetes Architecture">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Nodes" href="/docs/concepts/architecture/nodes/"></a>

		
	
		
			

<a class="item" data-title="Master-Node communication" href="/docs/concepts/architecture/master-node-communication/"></a>

		
	
		
			

<a class="item" data-title="Concepts Underlying the Cloud Controller Manager" href="/docs/concepts/architecture/cloud-controller/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Containers">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Images" href="/docs/concepts/containers/images/"></a>

		
	
		
			

<a class="item" data-title="Container Environment Variables" href="/docs/concepts/containers/container-environment-variables/"></a>

		
	
		
			

<a class="item" data-title="Runtime Class" href="/docs/concepts/containers/runtime-class/"></a>

		
	
		
			

<a class="item" data-title="Container Lifecycle Hooks" href="/docs/concepts/containers/container-lifecycle-hooks/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Workloads">
	<div class="container">
		
		
	
	
	
	
		
			
<div class="item" data-title="Pods">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Pod Overview" href="/docs/concepts/workloads/pods/pod-overview/"></a>

		
	
		
			

<a class="item" data-title="Pods" href="/docs/concepts/workloads/pods/pod/"></a>

		
	
		
			

<a class="item" data-title="Pod Lifecycle" href="/docs/concepts/workloads/pods/pod-lifecycle/"></a>

		
	
		
			

<a class="item" data-title="Init Containers" href="/docs/concepts/workloads/pods/init-containers/"></a>

		
	
		
			

<a class="item" data-title="Pod Preset" href="/docs/concepts/workloads/pods/podpreset/"></a>

		
	
		
			

<a class="item" data-title="Disruptions" href="/docs/concepts/workloads/pods/disruptions/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Controllers">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="ReplicaSet" href="/docs/concepts/workloads/controllers/replicaset/"></a>

		
	
		
			

<a class="item" data-title="ReplicationController" href="/docs/concepts/workloads/controllers/replicationcontroller/"></a>

		
	
		
			

<a class="item" data-title="Deployments" href="/docs/concepts/workloads/controllers/deployment/"></a>

		
	
		
			

<a class="item" data-title="StatefulSets" href="/docs/concepts/workloads/controllers/statefulset/"></a>

		
	
		
			

<a class="item" data-title="DaemonSet" href="/docs/concepts/workloads/controllers/daemonset/"></a>

		
	
		
			

<a class="item" data-title="Garbage Collection" href="/docs/concepts/workloads/controllers/garbage-collection/"></a>

		
	
		
			

<a class="item" data-title="TTL Controller for Finished Resources" href="/docs/concepts/workloads/controllers/ttlafterfinished/"></a>

		
	
		
			

<a class="item" data-title="Jobs - Run to Completion" href="/docs/concepts/workloads/controllers/jobs-run-to-completion/"></a>

		
	
		
			

<a class="item" data-title="CronJob" href="/docs/concepts/workloads/controllers/cron-jobs/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Services, Load Balancing, and Networking">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Services" href="/docs/concepts/services-networking/service/"></a>

		
	
		
			

<a class="item" data-title="DNS for Services and Pods" href="/docs/concepts/services-networking/dns-pod-service/"></a>

		
	
		
			

<a class="item" data-title="Connecting Applications with Services" href="/docs/concepts/services-networking/connect-applications-service/"></a>

		
	
		
			

<a class="item" data-title="Ingress" href="/docs/concepts/services-networking/ingress/"></a>

		
	
		
			

<a class="item" data-title="Ingress Controllers" href="/docs/concepts/services-networking/ingress-controllers/"></a>

		
	
		
			

<a class="item" data-title="Network Policies" href="/docs/concepts/services-networking/network-policies/"></a>

		
	
		
			

<a class="item" data-title="Adding entries to Pod /etc/hosts with HostAliases" href="/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Storage">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Volumes" href="/docs/concepts/storage/volumes/"></a>

		
	
		
			

<a class="item" data-title="Persistent Volumes" href="/docs/concepts/storage/persistent-volumes/"></a>

		
	
		
			

<a class="item" data-title="Volume Snapshots" href="/docs/concepts/storage/volume-snapshots/"></a>

		
	
		
			

<a class="item" data-title="Storage Classes" href="/docs/concepts/storage/storage-classes/"></a>

		
	
		
			

<a class="item" data-title="Volume Snapshot Classes" href="/docs/concepts/storage/volume-snapshot-classes/"></a>

		
	
		
			

<a class="item" data-title="Dynamic Volume Provisioning" href="/docs/concepts/storage/dynamic-provisioning/"></a>

		
	
		
			

<a class="item" data-title="Node-specific Volume Limits" href="/docs/concepts/storage/storage-limits/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Configuration">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Configuration Best Practices" href="/docs/concepts/configuration/overview/"></a>

		
	
		
			

<a class="item" data-title="Managing Compute Resources for Containers" href="/docs/concepts/configuration/manage-compute-resources-container/"></a>

		
	
		
			

<a class="item" data-title="Assigning Pods to Nodes" href="/docs/concepts/configuration/assign-pod-node/"></a>

		
	
		
			

<a class="item" data-title="Taints and Tolerations" href="/docs/concepts/configuration/taint-and-toleration/"></a>

		
	
		
			

<a class="item" data-title="Secrets" href="/docs/concepts/configuration/secret/"></a>

		
	
		
			

<a class="item" data-title="Organizing Cluster Access Using kubeconfig Files" href="/docs/concepts/configuration/organize-cluster-access-kubeconfig/"></a>

		
	
		
			

<a class="item" data-title="Pod Priority and Preemption" href="/docs/concepts/configuration/pod-priority-preemption/"></a>

		
	
		
			

<a class="item" data-title="Scheduler Performance Tuning" href="/docs/concepts/configuration/scheduler-perf-tuning/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Policies">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Resource Quotas" href="/docs/concepts/policy/resource-quotas/"></a>

		
	
		
			

<a class="item" data-title="Pod Security Policies" href="/docs/concepts/policy/pod-security-policy/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Cluster Administration">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Cluster Administration Overview" href="/docs/concepts/cluster-administration/cluster-administration-overview/"></a>

		
	
		
			

<a class="item" data-title="Certificates" href="/docs/concepts/cluster-administration/certificates/"></a>

		
	
		
			

<a class="item" data-title="Cloud Providers" href="/docs/concepts/cluster-administration/cloud-providers/"></a>

		
	
		
			

<a class="item" data-title="Managing Resources" href="/docs/concepts/cluster-administration/manage-deployment/"></a>

		
	
		
			

<a class="item" data-title="Cluster Networking" href="/docs/concepts/cluster-administration/networking/"></a>

		
	
		
			

<a class="item" data-title="Logging Architecture" href="/docs/concepts/cluster-administration/logging/"></a>

		
	
		
			

<a class="item" data-title="Configuring kubelet Garbage Collection" href="/docs/concepts/cluster-administration/kubelet-garbage-collection/"></a>

		
	
		
			

<a class="item" data-title="Federation" href="/docs/concepts/cluster-administration/federation/"></a>

		
	
		
			

<a class="item" data-title="Proxies in Kubernetes" href="/docs/concepts/cluster-administration/proxies/"></a>

		
	
		
			

<a class="item" data-title="Controller manager metrics" href="/docs/concepts/cluster-administration/controller-metrics/"></a>

		
	
		
			

<a class="item" data-title="Installing Addons" href="/docs/concepts/cluster-administration/addons/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Extending Kubernetes">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Extending your Kubernetes Cluster" href="/docs/concepts/extend-kubernetes/extend-cluster/"></a>

		
	
		
			
<div class="item" data-title="Extending the Kubernetes API">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Extending the Kubernetes API with the aggregation layer" href="/docs/concepts/extend-kubernetes/api-extension/apiserver-aggregation/"></a>

		
	
		
			

<a class="item" data-title="Custom Resources" href="/docs/concepts/extend-kubernetes/api-extension/custom-resources/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Compute, Storage, and Networking Extensions">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Network Plugins" href="/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/"></a>

		
	
		
			

<a class="item" data-title="Device Plugins" href="/docs/concepts/extend-kubernetes/compute-storage-net/device-plugins/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" data-title="Service Catalog" href="/docs/concepts/extend-kubernetes/service-catalog/"></a>

		
	
		
			

<a class="item" data-title="Poseidon-Firmament - An alternate scheduler" href="/docs/concepts/extend-kubernetes/poseidon-firmament-alternate-scheduler/"></a>

		
	

	</div>
</div>

		
	





     </div> 
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 


  <div id="docsContent">
  

<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/en/docs%5cconcepts%5cstorage%5cpersistent-volumes.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>

<h1>Persistent Volumes</h1>



<p>This document describes the current state of <code>PersistentVolumes</code> in Kubernetes. Familiarity with <a href="/docs/concepts/storage/volumes/">volumes</a> is suggested.</p>









<ul id="markdown-toc">










<li><a href="#introduction">Introduction</a></li>




<li><a href="#lifecycle-of-a-volume-and-claim">Lifecycle of a volume and claim</a></li>




<li><a href="#types-of-persistent-volumes">Types of Persistent Volumes</a></li>




<li><a href="#persistent-volumes">Persistent Volumes</a></li>




<li><a href="#persistentvolumeclaims">PersistentVolumeClaims</a></li>




<li><a href="#claims-as-volumes">Claims As Volumes</a></li>




<li><a href="#raw-block-volume-support">Raw Block Volume Support</a></li>




<li><a href="#volume-snapshot-and-restore-volume-from-snapshot-support">Volume Snapshot and Restore Volume from Snapshot Support</a></li>




<li><a href="#writing-portable-configuration">Writing Portable Configuration</a></li>



















</ul>


<h2 id="introduction">Introduction</h2>

<p>Managing storage is a distinct problem from managing compute. The <code>PersistentVolume</code> subsystem provides an API for users and administrators that abstracts details of how storage is provided from how it is consumed. To do this we introduce two new API resources:  <code>PersistentVolume</code> and <code>PersistentVolumeClaim</code>.</p>

<p>A <code>PersistentVolume</code> (PV) is a piece of storage in the cluster that has been provisioned by an administrator. It is a resource in the cluster just like a node is a cluster resource. PVs are volume plugins like Volumes, but have a lifecycle independent of any individual pod that uses the PV. This API object captures the details of the implementation of the storage, be that NFS, iSCSI, or a cloud-provider-specific storage system.</p>

<p>A <code>PersistentVolumeClaim</code> (PVC) is a request for storage by a user. It is similar to a pod. Pods consume node resources and PVCs consume PV resources. Pods can request specific levels of resources (CPU and Memory).  Claims can request specific size and access modes (e.g., can be mounted once read/write or many times read-only).</p>

<p>While <code>PersistentVolumeClaims</code> allow a user to consume abstract storage
resources, it is common that users need <code>PersistentVolumes</code> with varying
properties, such as performance, for different problems. Cluster administrators
need to be able to offer a variety of <code>PersistentVolumes</code> that differ in more
ways than just size and access modes, without exposing users to the details of
how those volumes are implemented. For these needs there is the <code>StorageClass</code>
resource.</p>

<p>Please see the <a href="/docs/tasks/configure-pod-container/configure-persistent-volume-storage/">detailed walkthrough with working examples</a>.</p>

<h2 id="lifecycle-of-a-volume-and-claim">Lifecycle of a volume and claim</h2>

<p>PVs are resources in the cluster. PVCs are requests for those resources and also act as claim checks to the resource. The interaction between PVs and PVCs follows this lifecycle:</p>

<h3 id="provisioning">Provisioning</h3>

<p>There are two ways PVs may be provisioned: statically or dynamically.</p>

<h4 id="static">Static</h4>

<p>A cluster administrator creates a number of PVs. They carry the details of the real storage which is available for use by cluster users. They exist in the Kubernetes API and are available for consumption.</p>

<h4 id="dynamic">Dynamic</h4>

<p>When none of the static PVs the administrator created matches a user&rsquo;s <code>PersistentVolumeClaim</code>,
the cluster may try to dynamically provision a volume specially for the PVC.
This provisioning is based on <code>StorageClasses</code>: the PVC must request a
<a href="/docs/concepts/storage/storage-classes/">storage class</a> and
the administrator must have created and configured that class in order for dynamic
provisioning to occur. Claims that request the class <code>&quot;&quot;</code> effectively disable
dynamic provisioning for themselves.</p>

<p>To enable dynamic storage provisioning based on storage class, the cluster administrator
needs to enable the <code>DefaultStorageClass</code> <a href="/docs/reference/access-authn-authz/admission-controllers/#defaultstorageclass">admission controller</a>
on the API server. This can be done, for example, by ensuring that <code>DefaultStorageClass</code> is
among the comma-delimited, ordered list of values for the <code>--enable-admission-plugins</code> flag of
the API server component. For more information on API server command line flags,
please check <a href="/docs/admin/kube-apiserver/">kube-apiserver</a> documentation.</p>

<h3 id="binding">Binding</h3>

<p>A user creates, or has already created in the case of dynamic provisioning, a <code>PersistentVolumeClaim</code> with a specific amount of storage requested and with certain access modes. A control loop in the master watches for new PVCs, finds a matching PV (if possible), and binds them together. If a PV was dynamically provisioned for a new PVC, the loop will always bind that PV to the PVC. Otherwise, the user will always get at least what they asked for, but the volume may be in excess of what was requested. Once bound, <code>PersistentVolumeClaim</code> binds are exclusive, regardless of how they were bound. A PVC to PV binding is a one-to-one mapping.</p>

<p>Claims will remain unbound indefinitely if a matching volume does not exist. Claims will be bound as matching volumes become available. For example, a cluster provisioned with many 50Gi PVs would not match a PVC requesting 100Gi. The PVC can be bound when a 100Gi PV is added to the cluster.</p>

<h3 id="using">Using</h3>

<p>Pods use claims as volumes. The cluster inspects the claim to find the bound volume and mounts that volume for a pod. For volumes which support multiple access modes, the user specifies which mode is desired when using their claim as a volume in a pod.</p>

<p>Once a user has a claim and that claim is bound, the bound PV belongs to the user for as long as they need it. Users schedule Pods and access their claimed PVs by including a <code>persistentVolumeClaim</code> in their Pod&rsquo;s volumes block. <a href="#claims-as-volumes">See below for syntax details</a>.</p>

<h3 id="storage-object-in-use-protection">Storage Object in Use Protection</h3>

<p>The purpose of the Storage Object in Use Protection feature is to ensure that Persistent Volume Claims (PVCs) in active use by a pod and Persistent Volume (PVs) that are bound to PVCs are not removed from the system as this may result in data loss.</p>

<blockquote class="note">
  <div><strong>Note:</strong> PVC is in active use by a pod when the pod status is <code>Pending</code> and the pod is assigned to a node or the pod status is <code>Running</code>.</div>
</blockquote>

<p>When the <a href="/docs/tasks/administer-cluster/storage-object-in-use-protection/">Storage Object in Use Protection feature</a> is enabled, if a user deletes a PVC in active use by a pod, the PVC is not removed immediately. PVC removal is postponed until the PVC is no longer actively used by any pods, and also if admin deletes a PV that is bound to a PVC, the PV is not removed immediately. PV removal is postponed until the PV is not bound to a PVC any more.</p>

<p>You can see that a PVC is protected when the PVC&rsquo;s status is <code>Terminating</code> and the <code>Finalizers</code> list includes <code>kubernetes.io/pvc-protection</code>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl describe pvc hostpath
Name:          hostpath
Namespace:     default
StorageClass:  example-hostpath
Status:        Terminating
Volume:        
Labels:        &lt;none&gt;
Annotations:   volume.beta.kubernetes.io/storage-class<span style="color:#666">=</span>example-hostpath
               volume.beta.kubernetes.io/storage-provisioner<span style="color:#666">=</span>example.com/hostpath
Finalizers:    <span style="color:#666">[</span>kubernetes.io/pvc-protection<span style="color:#666">]</span>
...</code></pre></div>
<p>You can see that a PV is protected when the PV&rsquo;s status is <code>Terminating</code> and the <code>Finalizers</code> list includes <code>kubernetes.io/pv-protection</code> too:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl describe pv task-pv-volume
Name:            task-pv-volume
Labels:          <span style="color:#b8860b">type</span><span style="color:#666">=</span><span style="color:#a2f">local</span>
Annotations:     &lt;none&gt;
Finalizers:      <span style="color:#666">[</span>kubernetes.io/pv-protection<span style="color:#666">]</span>
StorageClass:    standard
Status:          Available
Claim:           
Reclaim Policy:  Delete
Access Modes:    RWO
Capacity:        1Gi
Message:         
Source:
    Type:          HostPath <span style="color:#666">(</span>bare host directory volume<span style="color:#666">)</span>
    Path:          /tmp/data
    HostPathType:  
Events:            &lt;none&gt;</code></pre></div>
<h3 id="reclaiming">Reclaiming</h3>

<p>When a user is done with their volume, they can delete the PVC objects from the API which allows reclamation of the resource. The reclaim policy for a <code>PersistentVolume</code> tells the cluster what to do with the volume after it has been released of its claim. Currently, volumes can either be Retained, Recycled or Deleted.</p>

<h4 id="retain">Retain</h4>

<p>The <code>Retain</code> reclaim policy allows for manual reclamation of the resource. When the <code>PersistentVolumeClaim</code> is deleted, the <code>PersistentVolume</code> still exists and the volume is considered &ldquo;released&rdquo;. But it is not yet available for another claim because the previous claimant&rsquo;s data remains on the volume. An administrator can manually reclaim the volume with the following steps.</p>

<ol>
<li>Delete the <code>PersistentVolume</code>. The associated storage asset in external infrastructure (such as an AWS EBS, GCE PD, Azure Disk, or Cinder volume) still exists after the PV is deleted.</li>
<li>Manually clean up the data on the associated storage asset accordingly.</li>
<li>Manually delete the associated storage asset, or if you want to reuse the same storage asset, create a new <code>PersistentVolume</code> with the storage asset definition.</li>
</ol>

<h4 id="delete">Delete</h4>

<p>For volume plugins that support the <code>Delete</code> reclaim policy, deletion removes both the <code>PersistentVolume</code> object from Kubernetes, as well as the associated storage asset in the external infrastructure, such as an AWS EBS, GCE PD, Azure Disk, or Cinder volume. Volumes that were dynamically provisioned inherit the <a href="#reclaim-policy">reclaim policy of their <code>StorageClass</code></a>, which defaults to <code>Delete</code>. The administrator should configure the <code>StorageClass</code> according to users&rsquo; expectations, otherwise the PV must be edited or patched after it is created. See <a href="/docs/tasks/administer-cluster/change-pv-reclaim-policy/">Change the Reclaim Policy of a PersistentVolume</a>.</p>

<h4 id="recycle">Recycle</h4>

<blockquote class="warning">
  <div><strong>Warning:</strong> The <code>Recycle</code> reclaim policy is deprecated. Instead, the recommended approach is to use dynamic provisioning.</div>
</blockquote>

<p>If supported by the underlying volume plugin, the <code>Recycle</code> reclaim policy performs a basic scrub (<code>rm -rf /thevolume/*</code>) on the volume and makes it available again for a new claim.</p>

<p>However, an administrator can configure a custom recycler pod template using the Kubernetes controller manager command line arguments as described <a href="/docs/admin/kube-controller-manager/">here</a>. The custom recycler pod template must contain a <code>volumes</code> specification, as shown in the example below:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>pv-recycler<span style="color:#bbb">
</span><span style="color:#bbb">  </span>namespace:<span style="color:#bbb"> </span>default<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>restartPolicy:<span style="color:#bbb"> </span>Never<span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>vol<span style="color:#bbb">
</span><span style="color:#bbb">    </span>hostPath:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>path:<span style="color:#bbb"> </span>/any/path/it/will/be/replaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>pv-recycler<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span><span style="color:#b44">&#34;k8s.gcr.io/busybox&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>command:<span style="color:#bbb"> </span>[<span style="color:#b44">&#34;/bin/sh&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;-c&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;test -e /scrub &amp;&amp; rm -rf /scrub/..?* /scrub/.[!.]* /scrub/*  &amp;&amp; test -z \&#34;$(ls -A /scrub)\&#34; || exit 1&#34;</span>]<span style="color:#bbb">
</span><span style="color:#bbb">    </span>volumeMounts:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>vol<span style="color:#bbb">
</span><span style="color:#bbb">      </span>mountPath:<span style="color:#bbb"> </span>/scrub</code></pre></div>
<p>However, the particular path specified in the custom recycler pod template in the <code>volumes</code> part is replaced with the particular path of the volume that is being recycled.</p>

<h3 id="expanding-persistent-volumes-claims">Expanding Persistent Volumes Claims</h3>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.8</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>alpha</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="alpha">
This feature is currently in a <em>alpha</em> state, meaning:</p>

<ul>
<li>The version names contain alpha (e.g. v1alpha1).</li>
<li>Might be buggy. Enabling the feature may expose bugs. Disabled by default.</li>
<li>Support for feature may be dropped at any time without notice.</li>
<li>The API may change in incompatible ways in a later software release without notice.</li>
<li>Recommended for use only in short-lived testing clusters, due to increased risk of bugs and lack of long-term support.</li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.11</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>beta</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="beta">
This feature is currently in a <em>beta</em> state, meaning:</p>

<ul>
<li>The version names contain beta (e.g. v2beta3).</li>
<li>Code is well tested. Enabling the feature is considered safe. Enabled by default.</li>
<li>Support for the overall feature will not be dropped, though details may change.</li>
<li>The schema and/or semantics of objects may change in incompatible ways in a subsequent beta or stable release. When this happens, we will provide instructions for migrating to the next version. This may require deleting, editing, and re-creating API objects. The editing process may require some thought. This may require downtime for applications that rely on the feature.</li>
<li>Recommended for only non-business-critical uses because of potential for incompatible changes in subsequent releases. If you have multiple clusters that can be upgraded independently, you may be able to relax this restriction.</li>
<li><strong>Please do try our beta features and give feedback on them! After they exit beta, it may not be practical for us to make more changes.</strong></li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>Support for expanding PersistentVolumeClaims (PVCs) is now enabled by default. You can expand
the following types of volumes:</p>

<ul>
<li>gcePersistentDisk</li>
<li>awsElasticBlockStore</li>
<li>Cinder</li>
<li>glusterfs</li>
<li>rbd</li>
<li>Azure File</li>
<li>Azure Disk</li>
<li>Portworx</li>
<li>FlexVolumes</li>
</ul>

<p>You can only expand a PVC if its storage class&rsquo;s <code>allowVolumeExpansion</code> field is set to true.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>StorageClass<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>storage.k8s.io/v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>gluster-vol-default<span style="color:#bbb">
</span><span style="color:#bbb"></span>provisioner:<span style="color:#bbb"> </span>kubernetes.io/glusterfs<span style="color:#bbb">
</span><span style="color:#bbb"></span>parameters:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>resturl:<span style="color:#bbb"> </span><span style="color:#b44">&#34;http://192.168.10.100:8080&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>restuser:<span style="color:#bbb"> </span><span style="color:#b44">&#34;&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>secretNamespace:<span style="color:#bbb"> </span><span style="color:#b44">&#34;&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>secretName:<span style="color:#bbb"> </span><span style="color:#b44">&#34;&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>allowVolumeExpansion:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span></code></pre></div>
<p>To request a larger volume for a PVC, edit the PVC object and specify a larger
size. This triggers expansion of the volume that backs the underlying <code>PersistentVolume</code>. A
new <code>PersistentVolume</code> is never created to satisfy the claim. Instead, an existing volume is resized.</p>

<h4 id="resizing-a-volume-containing-a-file-system">Resizing a volume containing a file system</h4>

<p>You can only resize volumes containing a file system if the file system is XFS, Ext3, or Ext4.</p>

<p>When a volume contains a file system, the file system is only resized when a new Pod is started using
the <code>PersistentVolumeClaim</code> in ReadWrite mode. Therefore, if a pod or deployment is using a volume and
you want to expand it, you need to delete or recreate the pod after the volume has been expanded by the cloud provider in the controller-manager. You can check the status of resize operation by running the <code>kubectl describe pvc</code> command:</p>

<pre><code>kubectl describe pvc &lt;pvc_name&gt;
</code></pre>

<p>If the <code>PersistentVolumeClaim</code> has the status <code>FileSystemResizePending</code>, it is safe to recreate the pod using the PersistentVolumeClaim.</p>

<p>FlexVolumes allow resize if the driver is set with the <code>RequiresFSResize</code> capability to true.
The FlexVolume can be resized on pod restart.</p>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.11</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>alpha</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="alpha">
This feature is currently in a <em>alpha</em> state, meaning:</p>

<ul>
<li>The version names contain alpha (e.g. v1alpha1).</li>
<li>Might be buggy. Enabling the feature may expose bugs. Disabled by default.</li>
<li>Support for feature may be dropped at any time without notice.</li>
<li>The API may change in incompatible ways in a later software release without notice.</li>
<li>Recommended for use only in short-lived testing clusters, due to increased risk of bugs and lack of long-term support.</li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<h4 id="resizing-an-in-use-persistentvolumeclaim">Resizing an in-use PersistentVolumeClaim</h4>

<p>Expanding in-use PVCs is an alpha feature. To use it, enable the <code>ExpandInUsePersistentVolumes</code> feature gate.
In this case, you don&rsquo;t need to delete and recreate a Pod or deployment that is using an existing PVC.
Any in-use PVC automatically becomes available to its Pod as soon as its file system has been expanded.
This feature has no effect on PVCs that are not in use by a Pod or deployment. You must create a Pod which
uses the PVC before the expansion can complete.</p>

<p>Expanding in-use PVCs for FlexVolumes is added in release 1.13. To enable this feature use  <code>ExpandInUsePersistentVolumes</code> and <code>ExpandPersistentVolumes</code> feature gates. The <code>ExpandPersistentVolumes</code> feature gate is already enabled by default. If the <code>ExpandInUsePersistentVolumes</code> is set, FlexVolume can be resized online without pod restart.</p>

<blockquote class="note">
  <div><strong>Note:</strong> <strong>Note:</strong> FlexVolume resize is possible only when the underlying driver supports resize.</div>
</blockquote>

<blockquote class="note">
  <div><strong>Note:</strong> Expanding EBS volumes is a time consuming operation. Also, there is a per-volume quota of one modification every 6 hours.</div>
</blockquote>

<h2 id="types-of-persistent-volumes">Types of Persistent Volumes</h2>

<p><code>PersistentVolume</code> types are implemented as plugins.  Kubernetes currently supports the following plugins:</p>

<ul>
<li>GCEPersistentDisk</li>
<li>AWSElasticBlockStore</li>
<li>AzureFile</li>
<li>AzureDisk</li>
<li>FC (Fibre Channel)</li>
<li>Flexvolume</li>
<li>Flocker</li>
<li>NFS</li>
<li>iSCSI</li>
<li>RBD (Ceph Block Device)</li>
<li>CephFS</li>
<li>Cinder (OpenStack block storage)</li>
<li>Glusterfs</li>
<li>VsphereVolume</li>
<li>Quobyte Volumes</li>
<li>HostPath (Single node testing only &ndash; local storage is not supported in any way and WILL NOT WORK in a multi-node cluster)</li>
<li>Portworx Volumes</li>
<li>ScaleIO Volumes</li>
<li>StorageOS</li>
</ul>

<h2 id="persistent-volumes">Persistent Volumes</h2>

<p>Each PV contains a spec and status, which is the specification and status of the volume.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>PersistentVolume<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>pv0003<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>capacity:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>storage:<span style="color:#bbb"> </span>5Gi<span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumeMode:<span style="color:#bbb"> </span>Filesystem<span style="color:#bbb">
</span><span style="color:#bbb">  </span>accessModes:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>ReadWriteOnce<span style="color:#bbb">
</span><span style="color:#bbb">  </span>persistentVolumeReclaimPolicy:<span style="color:#bbb"> </span>Recycle<span style="color:#bbb">
</span><span style="color:#bbb">  </span>storageClassName:<span style="color:#bbb"> </span>slow<span style="color:#bbb">
</span><span style="color:#bbb">  </span>mountOptions:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>hard<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>nfsvers=<span style="color:#666">4.1</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>nfs:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>path:<span style="color:#bbb"> </span>/tmp<span style="color:#bbb">
</span><span style="color:#bbb">    </span>server:<span style="color:#bbb"> </span><span style="color:#666">172.17</span>.<span style="color:#666">0.2</span></code></pre></div>
<h3 id="capacity">Capacity</h3>

<p>Generally, a PV will have a specific storage capacity.  This is set using the PV&rsquo;s <code>capacity</code> attribute.  See the Kubernetes <a href="https://git.k8s.io/community/contributors/design-proposals/scheduling/resources.md" target="_blank">Resource Model</a> to understand the units expected by <code>capacity</code>.</p>

<p>Currently, storage size is the only resource that can be set or requested.  Future attributes may include IOPS, throughput, etc.</p>

<h3 id="volume-mode">Volume Mode</h3>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.13</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>beta</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="beta">
This feature is currently in a <em>beta</em> state, meaning:</p>

<ul>
<li>The version names contain beta (e.g. v2beta3).</li>
<li>Code is well tested. Enabling the feature is considered safe. Enabled by default.</li>
<li>Support for the overall feature will not be dropped, though details may change.</li>
<li>The schema and/or semantics of objects may change in incompatible ways in a subsequent beta or stable release. When this happens, we will provide instructions for migrating to the next version. This may require deleting, editing, and re-creating API objects. The editing process may require some thought. This may require downtime for applications that rely on the feature.</li>
<li>Recommended for only non-business-critical uses because of potential for incompatible changes in subsequent releases. If you have multiple clusters that can be upgraded independently, you may be able to relax this restriction.</li>
<li><strong>Please do try our beta features and give feedback on them! After they exit beta, it may not be practical for us to make more changes.</strong></li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>Prior to Kubernetes 1.9, all volume plugins created a filesystem on the persistent volume.
Now, you can set the value of <code>volumeMode</code> to <code>raw</code> to use a raw block device, or <code>filesystem</code>
to use a filesystem. <code>filesystem</code> is the default if the value is omitted. This is an optional API
parameter.</p>

<h3 id="access-modes">Access Modes</h3>

<p>A <code>PersistentVolume</code> can be mounted on a host in any way supported by the resource provider.  As shown in the table below, providers will have different capabilities and each PV&rsquo;s access modes are set to the specific modes supported by that particular volume.  For example, NFS can support multiple read/write clients, but a specific NFS PV might be exported on the server as read-only.  Each PV gets its own set of access modes describing that specific PV&rsquo;s capabilities.</p>

<p>The access modes are:</p>

<ul>
<li>ReadWriteOnce &ndash; the volume can be mounted as read-write by a single node</li>
<li>ReadOnlyMany &ndash; the volume can be mounted read-only by many nodes</li>
<li>ReadWriteMany &ndash; the volume can be mounted as read-write by many nodes</li>
</ul>

<p>In the CLI, the access modes are abbreviated to:</p>

<ul>
<li>RWO - ReadWriteOnce</li>
<li>ROX - ReadOnlyMany</li>
<li>RWX - ReadWriteMany</li>
</ul>

<blockquote>
<p><strong>Important!</strong> A volume can only be mounted using one access mode at a time, even if it supports many.  For example, a GCEPersistentDisk can be mounted as ReadWriteOnce by a single node or ReadOnlyMany by many nodes, but not at the same time.</p>
</blockquote>

<table>
<thead>
<tr>
<th align="left">Volume Plugin</th>
<th align="center">ReadWriteOnce</th>
<th align="center">ReadOnlyMany</th>
<th align="center">ReadWriteMany</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">AWSElasticBlockStore</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">AzureFile</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
</tr>

<tr>
<td align="left">AzureDisk</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">CephFS</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
</tr>

<tr>
<td align="left">Cinder</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">FC</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">Flexvolume</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">depends on the driver</td>
</tr>

<tr>
<td align="left">Flocker</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">GCEPersistentDisk</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">Glusterfs</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
</tr>

<tr>
<td align="left">HostPath</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">iSCSI</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">Quobyte</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
</tr>

<tr>
<td align="left">NFS</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
</tr>

<tr>
<td align="left">RBD</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">VsphereVolume</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
<td align="center">- (works when pods are collocated)</td>
</tr>

<tr>
<td align="left">PortworxVolume</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
<td align="center">&#x2713;</td>
</tr>

<tr>
<td align="left">ScaleIO</td>
<td align="center">&#x2713;</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
</tr>

<tr>
<td align="left">StorageOS</td>
<td align="center">&#x2713;</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
</tbody>
</table>

<h3 id="class">Class</h3>

<p>A PV can have a class, which is specified by setting the
<code>storageClassName</code> attribute to the name of a
<a href="/docs/concepts/storage/storage-classes/">StorageClass</a>.
A PV of a particular class can only be bound to PVCs requesting
that class. A PV with no <code>storageClassName</code> has no class and can only be bound
to PVCs that request no particular class.</p>

<p>In the past, the annotation <code>volume.beta.kubernetes.io/storage-class</code> was used instead
of the <code>storageClassName</code> attribute. This annotation is still working, however
it will become fully deprecated in a future Kubernetes release.</p>

<h3 id="reclaim-policy">Reclaim Policy</h3>

<p>Current reclaim policies are:</p>

<ul>
<li>Retain &ndash; manual reclamation</li>
<li>Recycle &ndash; basic scrub (<code>rm -rf /thevolume/*</code>)</li>
<li>Delete &ndash; associated storage asset such as AWS EBS, GCE PD, Azure Disk, or OpenStack Cinder volume is deleted</li>
</ul>

<p>Currently, only NFS and HostPath support recycling. AWS EBS, GCE PD, Azure Disk, and Cinder volumes support deletion.</p>

<h3 id="mount-options">Mount Options</h3>

<p>A Kubernetes administrator can specify additional mount options for when a Persistent Volume is mounted on a node.</p>

<blockquote class="note">
  <div><strong>Note:</strong> Not all Persistent volume types support mount options.</div>
</blockquote>

<p>The following volume types support mount options:</p>

<ul>
<li>AWSElasticBlockStore</li>
<li>AzureDisk</li>
<li>AzureFile</li>
<li>CephFS</li>
<li>Cinder (OpenStack block storage)</li>
<li>GCEPersistentDisk</li>
<li>Glusterfs</li>
<li>NFS</li>
<li>Quobyte Volumes</li>
<li>RBD (Ceph Block Device)</li>
<li>StorageOS</li>
<li>VsphereVolume</li>
<li>iSCSI</li>
</ul>

<p>Mount options are not validated, so mount will simply fail if one is invalid.</p>

<p>In the past, the annotation <code>volume.beta.kubernetes.io/mount-options</code> was used instead
of the <code>mountOptions</code> attribute. This annotation is still working, however
it will become fully deprecated in a future Kubernetes release.</p>

<h3 id="node-affinity">Node Affinity</h3>

<blockquote class="note">
  <div><strong>Note:</strong> For most volume types, you do not need to set this field. It is automatically populated for <a href="/docs/concepts/storage/volumes/#awselasticblockstore">AWS EBS</a>, <a href="/docs/concepts/storage/volumes/#gcepersistentdisk">GCE PD</a> and <a href="/docs/concepts/storage/volumes/#azuredisk">Azure Disk</a> volume block types. You need to explicitly set this for <a href="/docs/concepts/storage/volumes/#local">local</a> volumes.</div>
</blockquote>

<p>A PV can specify <a href="/docs/reference/generated/kubernetes-api/v1.13/#volumenodeaffinity-v1-core">node affinity</a> to define constraints that limit what nodes this volume can be accessed from. Pods that use a PV will only be scheduled to nodes that are selected by the node affinity.</p>

<h3 id="phase">Phase</h3>

<p>A volume will be in one of the following phases:</p>

<ul>
<li>Available &ndash; a free resource that is not yet bound to a claim</li>
<li>Bound &ndash; the volume is bound to a claim</li>
<li>Released &ndash; the claim has been deleted, but the resource is not yet reclaimed by the cluster</li>
<li>Failed &ndash; the volume has failed its automatic reclamation</li>
</ul>

<p>The CLI will show the name of the PVC bound to the PV.</p>

<h2 id="persistentvolumeclaims">PersistentVolumeClaims</h2>

<p>Each PVC contains a spec and status, which is the specification and status of the claim.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>PersistentVolumeClaim<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>myclaim<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>accessModes:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>ReadWriteOnce<span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumeMode:<span style="color:#bbb"> </span>Filesystem<span style="color:#bbb">
</span><span style="color:#bbb">  </span>resources:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>requests:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>storage:<span style="color:#bbb"> </span>8Gi<span style="color:#bbb">
</span><span style="color:#bbb">  </span>storageClassName:<span style="color:#bbb"> </span>slow<span style="color:#bbb">
</span><span style="color:#bbb">  </span>selector:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>matchLabels:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>release:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>matchExpressions:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>-<span style="color:#bbb"> </span>{key:<span style="color:#bbb"> </span>environment,<span style="color:#bbb"> </span>operator:<span style="color:#bbb"> </span>In,<span style="color:#bbb"> </span>values:<span style="color:#bbb"> </span>[dev]}</code></pre></div>
<h3 id="access-modes-1">Access Modes</h3>

<p>Claims use the same conventions as volumes when requesting storage with specific access modes.</p>

<h3 id="volume-modes">Volume Modes</h3>

<p>Claims use the same convention as volumes to indicate the consumption of the volume as either a filesystem or block device.</p>

<h3 id="resources">Resources</h3>

<p>Claims, like pods, can request specific quantities of a resource.  In this case, the request is for storage.  The same <a href="https://git.k8s.io/community/contributors/design-proposals/scheduling/resources.md" target="_blank">resource model</a> applies to both volumes and claims.</p>

<h3 id="selector">Selector</h3>

<p>Claims can specify a <a href="/docs/concepts/overview/working-with-objects/labels/#label-selectors">label selector</a> to further filter the set of volumes. Only the volumes whose labels match the selector can be bound to the claim. The selector can consist of two fields:</p>

<ul>
<li><code>matchLabels</code> - the volume must have a label with this value</li>
<li><code>matchExpressions</code> - a list of requirements made by specifying key, list of values, and operator that relates the key and values. Valid operators include In, NotIn, Exists, and DoesNotExist.</li>
</ul>

<p>All of the requirements, from both <code>matchLabels</code> and <code>matchExpressions</code> are ANDed together – they must all be satisfied in order to match.</p>

<h3 id="class-1">Class</h3>

<p>A claim can request a particular class by specifying the name of a
<a href="/docs/concepts/storage/storage-classes/">StorageClass</a>
using the attribute <code>storageClassName</code>.
Only PVs of the requested class, ones with the same <code>storageClassName</code> as the PVC, can
be bound to the PVC.</p>

<p>PVCs don&rsquo;t necessarily have to request a class. A PVC with its <code>storageClassName</code> set
equal to <code>&quot;&quot;</code> is always interpreted to be requesting a PV with no class, so it
can only be bound to PVs with no class (no annotation or one set equal to
<code>&quot;&quot;</code>). A PVC with no <code>storageClassName</code> is not quite the same and is treated differently
by the cluster depending on whether the
<a href="/docs/reference/access-authn-authz/admission-controllers/#defaultstorageclass"><code>DefaultStorageClass</code> admission plugin</a>
is turned on.</p>

<ul>
<li>If the admission plugin is turned on, the administrator may specify a
default <code>StorageClass</code>. All PVCs that have no <code>storageClassName</code> can be bound only to
PVs of that default. Specifying a default <code>StorageClass</code> is done by setting the
annotation <code>storageclass.kubernetes.io/is-default-class</code> equal to &ldquo;true&rdquo; in
a <code>StorageClass</code> object. If the administrator does not specify a default, the
cluster responds to PVC creation as if the admission plugin were turned off. If
more than one default is specified, the admission plugin forbids the creation of
all PVCs.</li>
<li>If the admission plugin is turned off, there is no notion of a default
<code>StorageClass</code>. All PVCs that have no <code>storageClassName</code> can be bound only to PVs that
have no class. In this case, the PVCs that have no <code>storageClassName</code> are treated the
same way as PVCs that have their <code>storageClassName</code> set to <code>&quot;&quot;</code>.</li>
</ul>

<p>Depending on installation method, a default StorageClass may be deployed
to Kubernetes cluster by addon manager during installation.</p>

<p>When a PVC specifies a <code>selector</code> in addition to requesting a <code>StorageClass</code>,
the requirements are ANDed together: only a PV of the requested class and with
the requested labels may be bound to the PVC.</p>

<blockquote class="note">
  <div><strong>Note:</strong> Currently, a PVC with a non-empty <code>selector</code> can&rsquo;t have a PV dynamically provisioned for it.</div>
</blockquote>

<p>In the past, the annotation <code>volume.beta.kubernetes.io/storage-class</code> was used instead
of <code>storageClassName</code> attribute. This annotation is still working, however
it won&rsquo;t be supported in a future Kubernetes release.</p>

<h2 id="claims-as-volumes">Claims As Volumes</h2>

<p>Pods access storage by using the claim as a volume.  Claims must exist in the same namespace as the pod using the claim.  The cluster finds the claim in the pod&rsquo;s namespace and uses it to get the <code>PersistentVolume</code> backing the claim.  The volume is then mounted to the host and into the pod.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>myfrontend<span style="color:#bbb">
</span><span style="color:#bbb">      </span>image:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span><span style="color:#bbb">      </span>volumeMounts:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>-<span style="color:#bbb"> </span>mountPath:<span style="color:#bbb"> </span><span style="color:#b44">&#34;/var/www/html&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>name:<span style="color:#bbb"> </span>mypd<span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>mypd<span style="color:#bbb">
</span><span style="color:#bbb">      </span>persistentVolumeClaim:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>claimName:<span style="color:#bbb"> </span>myclaim</code></pre></div>
<h3 id="a-note-on-namespaces">A Note on Namespaces</h3>

<p><code>PersistentVolumes</code> binds are exclusive, and since <code>PersistentVolumeClaims</code> are namespaced objects, mounting claims with &ldquo;Many&rdquo; modes (<code>ROX</code>, <code>RWX</code>) is only possible within one namespace.</p>

<h2 id="raw-block-volume-support">Raw Block Volume Support</h2>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.13</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>beta</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="beta">
This feature is currently in a <em>beta</em> state, meaning:</p>

<ul>
<li>The version names contain beta (e.g. v2beta3).</li>
<li>Code is well tested. Enabling the feature is considered safe. Enabled by default.</li>
<li>Support for the overall feature will not be dropped, though details may change.</li>
<li>The schema and/or semantics of objects may change in incompatible ways in a subsequent beta or stable release. When this happens, we will provide instructions for migrating to the next version. This may require deleting, editing, and re-creating API objects. The editing process may require some thought. This may require downtime for applications that rely on the feature.</li>
<li>Recommended for only non-business-critical uses because of potential for incompatible changes in subsequent releases. If you have multiple clusters that can be upgraded independently, you may be able to relax this restriction.</li>
<li><strong>Please do try our beta features and give feedback on them! After they exit beta, it may not be practical for us to make more changes.</strong></li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>The following volume plugins support raw block volumes, including dynamic provisioning where
applicable.</p>

<ul>
<li>AWSElasticBlockStore</li>
<li>AzureDisk</li>
<li>FC (Fibre Channel)</li>
<li>GCEPersistentDisk</li>
<li>iSCSI</li>
<li>Local volume</li>
<li>RBD (Ceph Block Device)</li>
<li>VsphereVolume (alpha)</li>
</ul>

<blockquote class="note">
  <div><strong>Note:</strong> Only FC and iSCSI volumes supported raw block volumes in Kubernetes 1.9.
Support for the additional plugins was added in 1.10.</div>
</blockquote>

<h3 id="persistent-volumes-using-a-raw-block-volume">Persistent Volumes using a Raw Block Volume</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>PersistentVolume<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>block-pv<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>capacity:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>storage:<span style="color:#bbb"> </span>10Gi<span style="color:#bbb">
</span><span style="color:#bbb">  </span>accessModes:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>ReadWriteOnce<span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumeMode:<span style="color:#bbb"> </span>Block<span style="color:#bbb">
</span><span style="color:#bbb">  </span>persistentVolumeReclaimPolicy:<span style="color:#bbb"> </span>Retain<span style="color:#bbb">
</span><span style="color:#bbb">  </span>fc:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>targetWWNs:<span style="color:#bbb"> </span>[<span style="color:#b44">&#34;50060e801049cfd1&#34;</span>]<span style="color:#bbb">
</span><span style="color:#bbb">    </span>lun:<span style="color:#bbb"> </span><span style="color:#666">0</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>readOnly:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">false</span></code></pre></div>
<h3 id="persistent-volume-claim-requesting-a-raw-block-volume">Persistent Volume Claim requesting a Raw Block Volume</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>PersistentVolumeClaim<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>block-pvc<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>accessModes:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>ReadWriteOnce<span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumeMode:<span style="color:#bbb"> </span>Block<span style="color:#bbb">
</span><span style="color:#bbb">  </span>resources:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>requests:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>storage:<span style="color:#bbb"> </span>10Gi</code></pre></div>
<h3 id="pod-specification-adding-raw-block-device-path-in-container">Pod specification adding Raw Block Device path in container</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>pod-with-block-volume<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>fc-container<span style="color:#bbb">
</span><span style="color:#bbb">      </span>image:<span style="color:#bbb"> </span>fedora:<span style="color:#666">26</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>command:<span style="color:#bbb"> </span>[<span style="color:#b44">&#34;/bin/sh&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;-c&#34;</span>]<span style="color:#bbb">
</span><span style="color:#bbb">      </span>args:<span style="color:#bbb"> </span>[<span style="color:#bbb"> </span><span style="color:#b44">&#34;tail -f /dev/null&#34;</span><span style="color:#bbb"> </span>]<span style="color:#bbb">
</span><span style="color:#bbb">      </span>volumeDevices:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>data<span style="color:#bbb">
</span><span style="color:#bbb">          </span>devicePath:<span style="color:#bbb"> </span>/dev/xvda<span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>data<span style="color:#bbb">
</span><span style="color:#bbb">      </span>persistentVolumeClaim:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>claimName:<span style="color:#bbb"> </span>block-pvc</code></pre></div>
<blockquote class="note">
  <div><strong>Note:</strong> When adding a raw block device for a Pod, we specify the device path in the container instead of a mount path.</div>
</blockquote>

<h3 id="binding-block-volumes">Binding Block Volumes</h3>

<p>If a user requests a raw block volume by indicating this using the <code>volumeMode</code> field in the <code>PersistentVolumeClaim</code> spec, the binding rules differ slightly from previous releases that didn&rsquo;t consider this mode as part of the spec.
Listed is a table of possible combinations the user and admin might specify for requesting a raw block device. The table indicates if the volume will be bound or not given the combinations:
Volume binding matrix for statically provisioned volumes:</p>

<table>
<thead>
<tr>
<th>PV volumeMode</th>
<th align="center">PVC volumeMode</th>
<th align="right">Result</th>
</tr>
</thead>

<tbody>
<tr>
<td>unspecified</td>
<td align="center">unspecified</td>
<td align="right">BIND</td>
</tr>

<tr>
<td>unspecified</td>
<td align="center">Block</td>
<td align="right">NO BIND</td>
</tr>

<tr>
<td>unspecified</td>
<td align="center">Filesystem</td>
<td align="right">BIND</td>
</tr>

<tr>
<td>Block</td>
<td align="center">unspecified</td>
<td align="right">NO BIND</td>
</tr>

<tr>
<td>Block</td>
<td align="center">Block</td>
<td align="right">BIND</td>
</tr>

<tr>
<td>Block</td>
<td align="center">Filesystem</td>
<td align="right">NO BIND</td>
</tr>

<tr>
<td>Filesystem</td>
<td align="center">Filesystem</td>
<td align="right">BIND</td>
</tr>

<tr>
<td>Filesystem</td>
<td align="center">Block</td>
<td align="right">NO BIND</td>
</tr>

<tr>
<td>Filesystem</td>
<td align="center">unspecified</td>
<td align="right">BIND</td>
</tr>
</tbody>
</table>

<blockquote class="note">
  <div><strong>Note:</strong> Only statically provisioned volumes are supported for alpha release. Administrators should take care to consider these values when working with raw block devices.</div>
</blockquote>

<h2 id="volume-snapshot-and-restore-volume-from-snapshot-support">Volume Snapshot and Restore Volume from Snapshot Support</h2>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.12</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>alpha</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="alpha">
This feature is currently in a <em>alpha</em> state, meaning:</p>

<ul>
<li>The version names contain alpha (e.g. v1alpha1).</li>
<li>Might be buggy. Enabling the feature may expose bugs. Disabled by default.</li>
<li>Support for feature may be dropped at any time without notice.</li>
<li>The API may change in incompatible ways in a later software release without notice.</li>
<li>Recommended for use only in short-lived testing clusters, due to increased risk of bugs and lack of long-term support.</li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>Volume snapshot feature was added to support CSI Volume Plugins only. For details, see <a href="/docs/concepts/storage/volume-snapshots/">volume snapshots</a>.</p>

<p>To enable support for restoring a volume from a volume snapshot data source, enable the
<code>VolumeSnapshotDataSource</code> feature gate on the apiserver and controller-manager.</p>

<h3 id="create-persistent-volume-claim-from-volume-snapshot">Create Persistent Volume Claim from Volume Snapshot</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>PersistentVolumeClaim<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>restore-pvc<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>storageClassName:<span style="color:#bbb"> </span>csi-hostpath-sc<span style="color:#bbb">
</span><span style="color:#bbb">  </span>dataSource:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name:<span style="color:#bbb"> </span>new-snapshot-test<span style="color:#bbb">
</span><span style="color:#bbb">    </span>kind:<span style="color:#bbb"> </span>VolumeSnapshot<span style="color:#bbb">
</span><span style="color:#bbb">    </span>apiGroup:<span style="color:#bbb"> </span>snapshot.storage.k8s.io<span style="color:#bbb">
</span><span style="color:#bbb">  </span>accessModes:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>ReadWriteOnce<span style="color:#bbb">
</span><span style="color:#bbb">  </span>resources:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>requests:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>storage:<span style="color:#bbb"> </span>10Gi</code></pre></div>
<h2 id="writing-portable-configuration">Writing Portable Configuration</h2>

<p>If you&rsquo;re writing configuration templates or examples that run on a wide range of clusters
and need persistent storage, we recommend that you use the following pattern:</p>

<ul>
<li>Do include PersistentVolumeClaim objects in your bundle of config (alongside
Deployments, ConfigMaps, etc).</li>
<li>Do not include PersistentVolume objects in the config, since the user instantiating
the config may not have permission to create PersistentVolumes.</li>
<li>Give the user the option of providing a storage class name when instantiating
the template.

<ul>
<li>If the user provides a storage class name, put that value into the
<code>persistentVolumeClaim.storageClassName</code> field.
This will cause the PVC to match the right storage
class if the cluster has StorageClasses enabled by the admin.</li>
<li>If the user does not provide a storage class name, leave the
<code>persistentVolumeClaim.storageClassName</code> field as nil.</li>
<li>This will cause a PV to be automatically provisioned for the user with
the default StorageClass in the cluster.  Many cluster environments have
a default StorageClass installed, or administrators can create their own
default StorageClass.</li>
</ul></li>
<li>In your tooling, do watch for PVCs that are not getting bound after some time
and surface this to the user, as this may indicate that the cluster has no
dynamic storage support (in which case the user should create a matching PV)
or the cluster has no storage system (in which case the user cannot deploy
config requiring PVCs).</li>
</ul>














<nav class="pagination" style="font-size: 16px; font-weight: bold"><a class="nav nav-prev" href="/docs/concepts/storage/volumes/" title="Volumes"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Volumes</a>
<a class="nav nav-next" style="float:right"  href="/docs/concepts/storage/volume-snapshots/" title="Volume Snapshots">Next - Volume Snapshots <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav>


  
  <h2>Feedback</h2>
  <p class="feedback--prompt">Was this page helpful? </p>
  <button class="button feedback--yes">Yes</button>
  <button class="button feedback--no">No</button>
  <p class="feedback--response feedback--response__hidden">
    Thanks for the feedback. If you have a specific, answerable question about how to use Kubernetes,
    ask it on <a target="_blank" rel="noopener"
    href="https://stackoverflow.com/questions/tagged/kubernetes">Stack Overflow</a>. Open
    an issue in the GitHub repo if you want to <a class="feedback--link" target="_blank" rel="noopener"
    href="https://github.com/kubernetes/website/issues/new?title=Issue%20with%20k8s.io">report a problem</a> or
    <a class="feedback--link" target="_blank" rel="noopener"
    href="https://github.com/kubernetes/website/issues/new?title=Improvement%20for%20k8s.io">suggest an improvement</a>.
  </p>
  <script>
    const yes = document.querySelector('.feedback--yes');
    const no = document.querySelector('.feedback--no');
    document.querySelectorAll('.feedback--link').forEach(link => {
      link.href = link.href + window.location.pathname;
    });
    const sendFeedback = (value) => {
      if (!gtag) { console.log('!gtag'); }
      gtag('event', 'click', {
        'event_category': 'Helpful',
        'event_label': window.location.pathname,
        value
      });
    };
    const disableButtons = () => {
      yes.disabled = true;
      yes.classList.add('feedback--button__disabled');
      no.disabled = true;
      no.classList.add('feedback--button__disabled');
    };
    yes.addEventListener('click', () => {
      sendFeedback(1);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
    no.addEventListener('click', () => {
      sendFeedback(0);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
  </script>


  <div id="pre-footer"> 
  <hr />

  <div class="issue-button-container">
    <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs%5cconcepts%5cstorage%5cpersistent-volumes.md?pixel" alt="Analytics" /></a></p>
    
    
    <script type="text/javascript">
    PDRTJS_settings_8345992 = {
    "id" : "8345992",
    "unique_id" : "\/docs\/concepts\/storage\/persistent-volumes\/",
    "title" : "Persistent Volumes",
    "permalink" : "https:\/\/qinlj.github.io\/docs\/concepts\/storage\/persistent-volumes\/"
    };
    (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
    </script>
    <a href="" onclick="window.open('https://github.com/kubernetes/website/issues/new?title=Issue%20with%20' +
    'k8s.io'+window.location.pathname)" class="button issue">Create an Issue</a>
    
    
    
    <a href="https://github.com/kubernetes/website/edit/master/content/en/docs%5cconcepts%5cstorage%5cpersistent-volumes.md" class="button issue">Edit This Page</a>
    
  </div>
  

  <div id="lastedit" class="lastedit issue-button-container">
    Page last modified on January 16, 2019 at 5:16 PM PST by
    <a href="https://github.com/kubernetes/website/commit/0f6457d5dfaad7d5c50911edd5732eb93e9e2de4/">Fix the version state of BlockVolume (#12237)</a> (<a href="https://github.com/kubernetes/website/commits/master/content/en/docs%5cconcepts%5cstorage%5cpersistent-volumes.md">Page History</a>)
  </div>
  
</div>

  <div class="post-comment">
    
    


<div id="lv-container" data-id="city" data-uid="MTAyMC80MzQxMi8xOTk1Mw==">
  <script type="text/javascript">
    (function(d, s) {
      var j, e = d.getElementsByTagName(s)[0];

      if (typeof LivereTower === 'function') { return; }

      j = d.createElement(s);
      j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
      j.async = true;

      e.parentNode.insertBefore(j, e);
    })(document, 'script');
  </script>
  <noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
</div>



  </div>
  
  <div class="container" role="main" itemscope itemtype="http://schema.org/Article">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
        
        
<div>
  <section id="datecount">
    <h4 id="date"> Mon Jan 1, 0001</h4>
  </section>
  <h5 id="wc">100 Words|Read in about 0 Min</h5>
  <h5 id="tags">Tags: 
  </h5>
</div>
        
        <article role="main" class="blog-post" itemprop="articleBody" id="content">
          ...
          



          
          <div class="social-share" data-initialized="true" data-wechat-qrcode-title="不扫别后悔">
  <center>
    <font style="font-size:18px;color:darkcyan;">分享到：</font>
    <a href="#" class="social-share-icon icon-weibo"></a>
    <a href="#" class="social-share-icon icon-wechat"></a>
    <a href="#" class="social-share-icon icon-twitter"></a>
    <a href="#" class="social-share-icon icon-linkedin"></a>
    <a href="#" class="social-share-icon icon-facebook"></a>
    <a href="#" class="social-share-icon icon-qq"></a>
    <a href="#" class="social-share-icon icon-qzone"></a>
  </center>
</div>


<script src="https://hugo-picture.oss-cn-beijing.aliyuncs.com/social-share.min.js"></script>
          
        </article>
      </div>
    </div>
  </div>
</section>

<footer>
    <main class="light-text">
        <nav>
            
            
            
            <a href="/docs/home/">Home</a>
            
            <a href="/blog/">Blog</a>
            
            <a href="/partners/">Partners</a>
            
            <a href="/community/">Community</a>
            
            <a href="/case-studies/">Case Studies</a>
            
        </nav>
        <div class="social">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
            <div>
                
                <a href="https://git.k8s.io/community/contributors/guide" class="button">Contribute</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2019 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a></a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2019 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
        <div id="miceType" class="center">
            ICP license: 京ICP备17074266号-3
        </div>
    </main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<script>

(function () {
    window.addEventListener('DOMContentLoaded', init)

        
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>



<script language="application/javascript">
  
  (function addHeadingLinks(){
    var article = document.getElementById('docsContent');
    var headings = article.querySelectorAll('h1, h2, h3, h4, h5, h6');
    headings.forEach(function(heading){
      if(heading.id){
        var a = document.createElement('a');
        a.innerHTML = heading.innerHTML;
        a.href = '#'+heading.id;
        a.classList.add('inpage_heading');
        heading.innerHTML = '';
        heading.appendChild(a);
      }
    });
  })();
</script>
</body>
</html>