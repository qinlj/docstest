<!DOCTYPE html>
<html id="docs" lang="en" class="">
<head>
  

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-36037335-10');
</script>
<meta charset="utf-8">
<title>Services - SuperMap iDesktop .NET</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
<link rel="stylesheet" href="/css/base_fonts.css">
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="/css/jquery-ui.min.css">
<link rel="stylesheet" href="/css/sweetalert.min.css">
<link rel="stylesheet" href="/css/callouts.css">
<link rel="stylesheet" href="/css/custom-jekyll/tags.css">
<link rel="stylesheet" href="https://qinlj.github.io/css/main.css" />
<link rel="stylesheet" href="https://qinlj.github.io/css/share.min.css" />



<meta name="description" content="">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:url" content="https://qinlj.github.io/docs/concepts/services-networking/service/">
<meta property="og:title" content="Services">
<meta name="twitter:title" content="Services">

<meta name="twitter:image:alt"   content="SuperMap iDesktop .NET">

<meta property="og:image" content="/images/kubernetes-horizontal-color.png">

<meta property="og:type" content="article">
<script src="/js/anchor-4.1.1.min.js"></script>
<script src="/js/jquery-3.2.1.min.js"></script>
<script src="/js/jquery-ui-1.12.1.min.js"></script>
<script src="/js/bootstrap-3.3.7.min.js"></script>
<script src="/js/sweetalert-1.1.3.min.js"></script>
<script src="/js/script.js"></script>
<script src="/js/custom-jekyll/tags.js"></script>


</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>
  <div class="left-buttons" data-auto-burger="primary">
    <ul class="global-nav">
      <li>
        <a href="#">
          v1.13 <span class="ui-icon ui-icon-carat-1-s"></span>
        </a>
        <ul>
          
          <li><a href="https://kubernetes.io">v1.13</a></li>
          
          <li><a href="https://supermaphehh.github.io/zh/">iDesktop .NET</a></li>
          
          <li><a href="https://v1-12.docs.kubernetes.io">v1.12</a></li>
          
          <li><a href="https://v1-11.docs.kubernetes.io">v1.11</a></li>
          
          <li><a href="https://v1-10.docs.kubernetes.io">v1.10</a></li>
          
          <li><a href="https://v1-9.docs.kubernetes.io">v1.9</a></li>
          
        </ul>
      </li>
    </ul>
  </div>
    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            
            
            <li><a href="/docs/" class="active">Documentation</a></li>
            
            <li><a href="/blog/">Blog</a></li>
            
            <li><a href="/partners/">Partners</a></li>
            
            <li><a href="/community/">Community</a></li>
            
            <li><a href="/case-studies/">Case Studies</a></li>
            
            
            
             <li>
                <a href="#">
                    English <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="/zh/docs/concepts/services-networking/service/">中文 Chinese</a></li>
                
                </ul>
            </li>

            <li>
                <a href="#">
                    v1.13 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="https://kubernetes.io">v1.13</a></li>
                
                    <li><a href="https://supermaphehh.github.io/zh/">iDesktop .NET</a></li>
                
                    <li><a href="https://v1-12.docs.kubernetes.io">v1.12</a></li>
                
                    <li><a href="https://v1-11.docs.kubernetes.io">v1.11</a></li>
                
                    <li><a href="https://v1-10.docs.kubernetes.io">v1.10</a></li>
                
                    <li><a href="https://v1-9.docs.kubernetes.io">v1.9</a></li>
                
                </ul>
            </li>
        </ul>

        <form id="searchBox" action="/search/">
          <input type="text" id="search" name="q" placeholder="Search" aria-label="Search">
        </form>

    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
         
           <div class="nav-box">
            <h3><a href="/docs/tutorials/hello-minikube/">Get Started</a></h3>
           <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>

        </div>
         
           <div class="nav-box">
            <h3><a href="/docs/home/">Documentation</a></h3>
           <p>Learn how to use Kubernetes with conceptual, tutorial, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>

        </div>
         
           <div class="nav-box">
            <h3><a href="/blog/">Blog</a></h3>
           <p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>

        </div>
         
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack Slack</span></a>
                <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>



<section id="hero" class="light-text no-sub">
  











<h1>Concepts</h1>
<h5></h5>










<div id="vendorStrip" class="light-text">
	<ul>
		
		
		<li><a href="/docs/home/">HOME</a></li>
		
		
		<li><a href="/docs/surfaceanalyst/">SURFACEANALYSIS</a></li>
		
		
		<li><a href="/docs/setup/">SETUP</a></li>
		
		
		<li><a href="/docs/concepts/" class="YAH">CONCEPTS</a></li>
		
		
		<li><a href="/docs/tasks/">TASKS</a></li>
		
		
		<li><a href="/docs/tutorials/">TUTORIALS</a></li>
		
		
		<li><a href="/docs/reference/">REFERENCE</a></li>
		
		
		<li><a href="/docs/contribute/">CONTRIBUTE</a></li>
		
	</ul>
	<form id="searchBox" action="/docs/search/">
		<input type="text" id="search" name="q" placeholder="Search" aria-label="Search">
  </form>
</div>

</section>



<section id="encyclopedia">
  
<div id="docsToc">
     <div class="pi-accordion">
    	
        
        
        
        
        
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
                          
                          
                 
             
         
             
         
             
         
             
         
             
         
             
         
         
        
        <a class="item" data-title="Concepts" href="/docs/concepts/"></a>

	
	
	
	
		
			
<div class="item" data-title="Overview">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="What is Kubernetes?" href="/docs/concepts/overview/what-is-kubernetes/"></a>

		
	
		
			

<a class="item" data-title="Kubernetes Components" href="/docs/concepts/overview/components/"></a>

		
	
		
			

<a class="item" data-title="The Kubernetes API" href="/docs/concepts/overview/kubernetes-api/"></a>

		
	
		
			
<div class="item" data-title="Working with Kubernetes Objects">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Understanding Kubernetes Objects" href="/docs/concepts/overview/working-with-objects/kubernetes-objects/"></a>

		
	
		
			

<a class="item" data-title="Names" href="/docs/concepts/overview/working-with-objects/names/"></a>

		
	
		
			

<a class="item" data-title="Namespaces" href="/docs/concepts/overview/working-with-objects/namespaces/"></a>

		
	
		
			

<a class="item" data-title="Labels and Selectors" href="/docs/concepts/overview/working-with-objects/labels/"></a>

		
	
		
			

<a class="item" data-title="Annotations" href="/docs/concepts/overview/working-with-objects/annotations/"></a>

		
	
		
			

<a class="item" data-title="Field Selectors" href="/docs/concepts/overview/working-with-objects/field-selectors/"></a>

		
	
		
			

<a class="item" data-title="Recommended Labels" href="/docs/concepts/overview/working-with-objects/common-labels/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Object Management Using kubectl">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Kubernetes Object Management" href="/docs/concepts/overview/object-management-kubectl/overview/"></a>

		
	
		
			

<a class="item" data-title="Managing Kubernetes Objects Using Imperative Commands" href="/docs/concepts/overview/object-management-kubectl/imperative-command/"></a>

		
	
		
			

<a class="item" data-title="Imperative Management of Kubernetes Objects Using Configuration Files" href="/docs/concepts/overview/object-management-kubectl/imperative-config/"></a>

		
	
		
			

<a class="item" data-title="Declarative Management of Kubernetes Objects Using Configuration Files" href="/docs/concepts/overview/object-management-kubectl/declarative-config/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Kubernetes Architecture">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Nodes" href="/docs/concepts/architecture/nodes/"></a>

		
	
		
			

<a class="item" data-title="Master-Node communication" href="/docs/concepts/architecture/master-node-communication/"></a>

		
	
		
			

<a class="item" data-title="Concepts Underlying the Cloud Controller Manager" href="/docs/concepts/architecture/cloud-controller/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Containers">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Images" href="/docs/concepts/containers/images/"></a>

		
	
		
			

<a class="item" data-title="Container Environment Variables" href="/docs/concepts/containers/container-environment-variables/"></a>

		
	
		
			

<a class="item" data-title="Runtime Class" href="/docs/concepts/containers/runtime-class/"></a>

		
	
		
			

<a class="item" data-title="Container Lifecycle Hooks" href="/docs/concepts/containers/container-lifecycle-hooks/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Workloads">
	<div class="container">
		
		
	
	
	
	
		
			
<div class="item" data-title="Pods">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Pod Overview" href="/docs/concepts/workloads/pods/pod-overview/"></a>

		
	
		
			

<a class="item" data-title="Pods" href="/docs/concepts/workloads/pods/pod/"></a>

		
	
		
			

<a class="item" data-title="Pod Lifecycle" href="/docs/concepts/workloads/pods/pod-lifecycle/"></a>

		
	
		
			

<a class="item" data-title="Init Containers" href="/docs/concepts/workloads/pods/init-containers/"></a>

		
	
		
			

<a class="item" data-title="Pod Preset" href="/docs/concepts/workloads/pods/podpreset/"></a>

		
	
		
			

<a class="item" data-title="Disruptions" href="/docs/concepts/workloads/pods/disruptions/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Controllers">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="ReplicaSet" href="/docs/concepts/workloads/controllers/replicaset/"></a>

		
	
		
			

<a class="item" data-title="ReplicationController" href="/docs/concepts/workloads/controllers/replicationcontroller/"></a>

		
	
		
			

<a class="item" data-title="Deployments" href="/docs/concepts/workloads/controllers/deployment/"></a>

		
	
		
			

<a class="item" data-title="StatefulSets" href="/docs/concepts/workloads/controllers/statefulset/"></a>

		
	
		
			

<a class="item" data-title="DaemonSet" href="/docs/concepts/workloads/controllers/daemonset/"></a>

		
	
		
			

<a class="item" data-title="Garbage Collection" href="/docs/concepts/workloads/controllers/garbage-collection/"></a>

		
	
		
			

<a class="item" data-title="TTL Controller for Finished Resources" href="/docs/concepts/workloads/controllers/ttlafterfinished/"></a>

		
	
		
			

<a class="item" data-title="Jobs - Run to Completion" href="/docs/concepts/workloads/controllers/jobs-run-to-completion/"></a>

		
	
		
			

<a class="item" data-title="CronJob" href="/docs/concepts/workloads/controllers/cron-jobs/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Services, Load Balancing, and Networking">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Services" href="/docs/concepts/services-networking/service/"></a>

		
	
		
			

<a class="item" data-title="DNS for Services and Pods" href="/docs/concepts/services-networking/dns-pod-service/"></a>

		
	
		
			

<a class="item" data-title="Connecting Applications with Services" href="/docs/concepts/services-networking/connect-applications-service/"></a>

		
	
		
			

<a class="item" data-title="Ingress" href="/docs/concepts/services-networking/ingress/"></a>

		
	
		
			

<a class="item" data-title="Ingress Controllers" href="/docs/concepts/services-networking/ingress-controllers/"></a>

		
	
		
			

<a class="item" data-title="Network Policies" href="/docs/concepts/services-networking/network-policies/"></a>

		
	
		
			

<a class="item" data-title="Adding entries to Pod /etc/hosts with HostAliases" href="/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Storage">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Volumes" href="/docs/concepts/storage/volumes/"></a>

		
	
		
			

<a class="item" data-title="Persistent Volumes" href="/docs/concepts/storage/persistent-volumes/"></a>

		
	
		
			

<a class="item" data-title="Volume Snapshots" href="/docs/concepts/storage/volume-snapshots/"></a>

		
	
		
			

<a class="item" data-title="Storage Classes" href="/docs/concepts/storage/storage-classes/"></a>

		
	
		
			

<a class="item" data-title="Volume Snapshot Classes" href="/docs/concepts/storage/volume-snapshot-classes/"></a>

		
	
		
			

<a class="item" data-title="Dynamic Volume Provisioning" href="/docs/concepts/storage/dynamic-provisioning/"></a>

		
	
		
			

<a class="item" data-title="Node-specific Volume Limits" href="/docs/concepts/storage/storage-limits/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Configuration">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Configuration Best Practices" href="/docs/concepts/configuration/overview/"></a>

		
	
		
			

<a class="item" data-title="Managing Compute Resources for Containers" href="/docs/concepts/configuration/manage-compute-resources-container/"></a>

		
	
		
			

<a class="item" data-title="Assigning Pods to Nodes" href="/docs/concepts/configuration/assign-pod-node/"></a>

		
	
		
			

<a class="item" data-title="Taints and Tolerations" href="/docs/concepts/configuration/taint-and-toleration/"></a>

		
	
		
			

<a class="item" data-title="Secrets" href="/docs/concepts/configuration/secret/"></a>

		
	
		
			

<a class="item" data-title="Organizing Cluster Access Using kubeconfig Files" href="/docs/concepts/configuration/organize-cluster-access-kubeconfig/"></a>

		
	
		
			

<a class="item" data-title="Pod Priority and Preemption" href="/docs/concepts/configuration/pod-priority-preemption/"></a>

		
	
		
			

<a class="item" data-title="Scheduler Performance Tuning" href="/docs/concepts/configuration/scheduler-perf-tuning/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Policies">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Resource Quotas" href="/docs/concepts/policy/resource-quotas/"></a>

		
	
		
			

<a class="item" data-title="Pod Security Policies" href="/docs/concepts/policy/pod-security-policy/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Cluster Administration">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Cluster Administration Overview" href="/docs/concepts/cluster-administration/cluster-administration-overview/"></a>

		
	
		
			

<a class="item" data-title="Certificates" href="/docs/concepts/cluster-administration/certificates/"></a>

		
	
		
			

<a class="item" data-title="Cloud Providers" href="/docs/concepts/cluster-administration/cloud-providers/"></a>

		
	
		
			

<a class="item" data-title="Managing Resources" href="/docs/concepts/cluster-administration/manage-deployment/"></a>

		
	
		
			

<a class="item" data-title="Cluster Networking" href="/docs/concepts/cluster-administration/networking/"></a>

		
	
		
			

<a class="item" data-title="Logging Architecture" href="/docs/concepts/cluster-administration/logging/"></a>

		
	
		
			

<a class="item" data-title="Configuring kubelet Garbage Collection" href="/docs/concepts/cluster-administration/kubelet-garbage-collection/"></a>

		
	
		
			

<a class="item" data-title="Federation" href="/docs/concepts/cluster-administration/federation/"></a>

		
	
		
			

<a class="item" data-title="Proxies in Kubernetes" href="/docs/concepts/cluster-administration/proxies/"></a>

		
	
		
			

<a class="item" data-title="Controller manager metrics" href="/docs/concepts/cluster-administration/controller-metrics/"></a>

		
	
		
			

<a class="item" data-title="Installing Addons" href="/docs/concepts/cluster-administration/addons/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Extending Kubernetes">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Extending your Kubernetes Cluster" href="/docs/concepts/extend-kubernetes/extend-cluster/"></a>

		
	
		
			
<div class="item" data-title="Extending the Kubernetes API">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Extending the Kubernetes API with the aggregation layer" href="/docs/concepts/extend-kubernetes/api-extension/apiserver-aggregation/"></a>

		
	
		
			

<a class="item" data-title="Custom Resources" href="/docs/concepts/extend-kubernetes/api-extension/custom-resources/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Compute, Storage, and Networking Extensions">
	<div class="container">
		
		
	
	
	
	
		
			

<a class="item" data-title="Network Plugins" href="/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/"></a>

		
	
		
			

<a class="item" data-title="Device Plugins" href="/docs/concepts/extend-kubernetes/compute-storage-net/device-plugins/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" data-title="Service Catalog" href="/docs/concepts/extend-kubernetes/service-catalog/"></a>

		
	
		
			

<a class="item" data-title="Poseidon-Firmament - An alternate scheduler" href="/docs/concepts/extend-kubernetes/poseidon-firmament-alternate-scheduler/"></a>

		
	

	</div>
</div>

		
	





     </div> 
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 


  <div id="docsContent">
  

<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/en/docs%5cconcepts%5cservices-networking%5cservice.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>

<h1>Services</h1>



<p>Kubernetes <a href="/docs/concepts/workloads/pods/pod/"><code>Pods</code></a> are mortal. They are born and when they die, they
are not resurrected.  <a href="/docs/concepts/workloads/controllers/replicaset/"><code>ReplicaSets</code></a> in
particular create and destroy <code>Pods</code> dynamically (e.g. when scaling out or in).  While each <code>Pod</code> gets its own IP address, even
those IP addresses cannot be relied upon to be stable over time. This leads to
a problem: if some set of <code>Pods</code> (let&rsquo;s call them backends) provides
functionality to other <code>Pods</code> (let&rsquo;s call them frontends) inside the Kubernetes
cluster, how do those frontends find out and keep track of which backends are
in that set?</p>

<p>Enter <code>Services</code>.</p>

<p>A Kubernetes <code>Service</code> is an abstraction which defines a logical set of <code>Pods</code>
and a policy by which to access them - sometimes called a micro-service.  The
set of <code>Pods</code> targeted by a <code>Service</code> is (usually) determined by a <a href="/docs/concepts/overview/working-with-objects/labels/#label-selectors"><code>Label
Selector</code></a> (see below for why you might want a
<code>Service</code> without a selector).</p>

<p>As an example, consider an image-processing backend which is running with 3
replicas.  Those replicas are fungible - frontends do not care which backend
they use.  While the actual <code>Pods</code> that compose the backend set may change, the
frontend clients should not need to be aware of that or keep track of the list
of backends themselves.  The <code>Service</code> abstraction enables this decoupling.</p>

<p>For Kubernetes-native applications, Kubernetes offers a simple <code>Endpoints</code> API
that is updated whenever the set of <code>Pods</code> in a <code>Service</code> changes.  For
non-native applications, Kubernetes offers a virtual-IP-based bridge to Services
which redirects to the backend <code>Pods</code>.</p>









<ul id="markdown-toc">










<li><a href="#defining-a-service">Defining a service</a></li>




<li><a href="#virtual-ips-and-service-proxies">Virtual IPs and service proxies</a></li>




<li><a href="#multi-port-services">Multi-Port Services</a></li>




<li><a href="#choosing-your-own-ip-address">Choosing your own IP address</a></li>




<li><a href="#discovering-services">Discovering services</a></li>




<li><a href="#headless-services">Headless services</a></li>




<li><a href="#publishing-services-service-types">Publishing services - service types</a></li>




<li><a href="#shortcomings">Shortcomings</a></li>




<li><a href="#future-work">Future work</a></li>




<li><a href="#the-gory-details-of-virtual-ips">The gory details of virtual IPs</a></li>




<li><a href="#api-object">API Object</a></li>




<li><a href="#protocol-support">Supported protocols</a></li>




















<li><a href="#what-s-next">What's next</a></li>



</ul>


<h2 id="defining-a-service">Defining a service</h2>

<p>A <code>Service</code> in Kubernetes is a REST object, similar to a <code>Pod</code>.  Like all of the
REST objects, a <code>Service</code> definition can be POSTed to the apiserver to create a
new instance.  For example, suppose you have a set of <code>Pods</code> that each expose
port 9376 and carry a label <code>&quot;app=MyApp&quot;</code>.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>Service<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>selector:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>app:<span style="color:#bbb"> </span>MyApp<span style="color:#bbb">
</span><span style="color:#bbb">  </span>ports:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>protocol:<span style="color:#bbb"> </span>TCP<span style="color:#bbb">
</span><span style="color:#bbb">    </span>port:<span style="color:#bbb"> </span><span style="color:#666">80</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>targetPort:<span style="color:#bbb"> </span><span style="color:#666">9376</span></code></pre></div>
<p>This specification will create a new <code>Service</code> object named &ldquo;my-service&rdquo; which
targets TCP port 9376 on any <code>Pod</code> with the <code>&quot;app=MyApp&quot;</code> label.  This <code>Service</code>
will also be assigned an IP address (sometimes called the &ldquo;cluster IP&rdquo;), which
is used by the service proxies (see below).  The <code>Service</code>&rsquo;s selector will be
evaluated continuously and the results will be POSTed to an <code>Endpoints</code> object
also named &ldquo;my-service&rdquo;.</p>

<p>Note that a <code>Service</code> can map an incoming port to any <code>targetPort</code>.  By default
the <code>targetPort</code> will be set to the same value as the <code>port</code> field.  Perhaps
more interesting is that <code>targetPort</code> can be a string, referring to the name of
a port in the backend <code>Pods</code>.  The actual port number assigned to that name can
be different in each backend <code>Pod</code>. This offers a lot of flexibility for
deploying and evolving your <code>Services</code>.  For example, you can change the port
number that pods expose in the next version of your backend software, without
breaking clients.</p>

<p><code>TCP</code> is the default protocol for services, and you can also use any other
<a href="#protocol-support">supported protocol</a>. At the moment, you can only set a
single <code>port</code> and <code>protocol</code> for a Service.</p>

<h3 id="services-without-selectors">Services without selectors</h3>

<p>Services generally abstract access to Kubernetes <code>Pods</code>, but they can also
abstract other kinds of backends.  For example:</p>

<ul>
<li>You want to have an external database cluster in production, but in test
you use your own databases.</li>
<li>You want to point your service to a service in another
<a href="/docs/concepts/overview/working-with-objects/namespaces/"><code>Namespace</code></a> or on another cluster.</li>
<li>You are migrating your workload to Kubernetes and some of your backends run
outside of Kubernetes.</li>
</ul>

<p>In any of these scenarios you can define a service without a selector:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>Service<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>ports:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>protocol:<span style="color:#bbb"> </span>TCP<span style="color:#bbb">
</span><span style="color:#bbb">    </span>port:<span style="color:#bbb"> </span><span style="color:#666">80</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>targetPort:<span style="color:#bbb"> </span><span style="color:#666">9376</span></code></pre></div>
<p>Because this service has no selector, the corresponding <code>Endpoints</code> object will not be
created. You can manually map the service to your own specific endpoints:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>Endpoints<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb"></span>subsets:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>addresses:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>-<span style="color:#bbb"> </span>ip:<span style="color:#bbb"> </span><span style="color:#666">1.2</span>.<span style="color:#666">3.4</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>ports:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>-<span style="color:#bbb"> </span>port:<span style="color:#bbb"> </span><span style="color:#666">9376</span></code></pre></div>
<blockquote class="note">
  <div><strong>Note:</strong> The endpoint IPs may not be loopback (127.0.0.0/8), link-local
(169.254.0.0/16), or link-local multicast (224.0.0.0/24). They cannot be the
cluster IPs of other Kubernetes services either because the <code>kube-proxy</code>
component doesn&rsquo;t support virtual IPs as destination yet.</div>
</blockquote>

<p>Accessing a <code>Service</code> without a selector works the same as if it had a selector.
The traffic will be routed to endpoints defined by the user (<code>1.2.3.4:9376</code> in
this example).</p>

<p>An ExternalName service is a special case of service that does not have
selectors and uses DNS names instead. For more information, see the
<a href="#externalname">ExternalName</a> section later in this document.</p>

<h2 id="virtual-ips-and-service-proxies">Virtual IPs and service proxies</h2>

<p>Every node in a Kubernetes cluster runs a <code>kube-proxy</code>. <code>kube-proxy</code> is
responsible for implementing a form of virtual IP for <code>Services</code> of type other
than <a href="#externalname"><code>ExternalName</code></a>.</p>

<p>In Kubernetes v1.0, <code>Services</code> are a &ldquo;layer 4&rdquo; (TCP/UDP over IP) construct, the
proxy was purely in userspace.  In Kubernetes v1.1, the <code>Ingress</code> API was added
(beta) to represent &ldquo;layer 7&rdquo;(HTTP) services, iptables proxy was added too,
and became the default operating mode since Kubernetes v1.2. In Kubernetes v1.8.0-beta.0,
ipvs proxy was added.</p>

<h3 id="proxy-mode-userspace">Proxy-mode: userspace</h3>

<p>In this mode, kube-proxy watches the Kubernetes master for the addition and
removal of <code>Service</code> and <code>Endpoints</code> objects. For each <code>Service</code> it opens a
port (randomly chosen) on the local node.  Any connections to this &ldquo;proxy port&rdquo;
will be proxied to one of the <code>Service</code>&rsquo;s backend <code>Pods</code> (as reported in
<code>Endpoints</code>).  Which backend <code>Pod</code>  to use is decided based on the
<code>SessionAffinity</code> of the <code>Service</code>.  Lastly, it installs iptables rules which
capture traffic to the <code>Service</code>&rsquo;s <code>clusterIP</code> (which is virtual) and <code>Port</code>
and redirects that traffic to the proxy port which proxies the backend <code>Pod</code>.
By default, the choice of backend is round robin.</p>

<p><img src="/images/docs/services-userspace-overview.svg" alt="Services overview diagram for userspace proxy" /></p>

<h3 id="proxy-mode-iptables">Proxy-mode: iptables</h3>

<p>In this mode, kube-proxy watches the Kubernetes master for the addition and
removal of <code>Service</code> and <code>Endpoints</code> objects. For each <code>Service</code>, it installs
iptables rules which capture traffic to the <code>Service</code>&rsquo;s <code>clusterIP</code> (which is
virtual) and <code>Port</code> and redirects that traffic to one of the <code>Service</code>&rsquo;s
backend sets.  For each <code>Endpoints</code> object, it installs iptables rules which
select a backend <code>Pod</code>. By default, the choice of backend is random.</p>

<p>Obviously, iptables need not switch back between userspace and kernelspace, it should be
faster and more reliable than the userspace proxy. However, unlike the
userspace proxier, the iptables proxier cannot automatically retry another
<code>Pod</code> if the one it initially selects does not respond, so it depends on
having working <a href="/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/#defining-readiness-probes">readiness probes</a>.</p>

<p><img src="/images/docs/services-iptables-overview.svg" alt="Services overview diagram for iptables proxy" /></p>

<h3 id="proxy-mode-ipvs">Proxy-mode: ipvs</h3>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.9</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>beta</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="beta">
This feature is currently in a <em>beta</em> state, meaning:</p>

<ul>
<li>The version names contain beta (e.g. v2beta3).</li>
<li>Code is well tested. Enabling the feature is considered safe. Enabled by default.</li>
<li>Support for the overall feature will not be dropped, though details may change.</li>
<li>The schema and/or semantics of objects may change in incompatible ways in a subsequent beta or stable release. When this happens, we will provide instructions for migrating to the next version. This may require deleting, editing, and re-creating API objects. The editing process may require some thought. This may require downtime for applications that rely on the feature.</li>
<li>Recommended for only non-business-critical uses because of potential for incompatible changes in subsequent releases. If you have multiple clusters that can be upgraded independently, you may be able to relax this restriction.</li>
<li><strong>Please do try our beta features and give feedback on them! After they exit beta, it may not be practical for us to make more changes.</strong></li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>In this mode, kube-proxy watches Kubernetes Services and Endpoints,
calls <code>netlink</code> interface to create ipvs rules accordingly and syncs ipvs rules with Kubernetes
Services and Endpoints periodically, to make sure ipvs status is
consistent with the expectation. When Service is accessed, traffic will
be redirected to one of the backend Pods.</p>

<p>Similar to iptables, Ipvs is based on netfilter hook function, but uses hash
table as the underlying data structure and works in the kernel space.
That means ipvs redirects traffic much faster, and has much
better performance when syncing proxy rules. Furthermore, ipvs provides more
options for load balancing algorithm, such as:</p>

<ul>
<li><code>rr</code>: round-robin</li>
<li><code>lc</code>: least connection</li>
<li><code>dh</code>: destination hashing</li>
<li><code>sh</code>: source hashing</li>
<li><code>sed</code>: shortest expected delay</li>
<li><code>nq</code>: never queue</li>
</ul>

<blockquote class="note">
  <div><strong>Note:</strong> ipvs mode assumes IPVS kernel modules are installed on the node
before running kube-proxy. When kube-proxy starts with ipvs proxy mode,
kube-proxy would validate if IPVS modules are installed on the node, if
it&rsquo;s not installed kube-proxy will fall back to iptables proxy mode.</div>
</blockquote>

<p><img src="/images/docs/services-ipvs-overview.svg" alt="Services overview diagram for ipvs proxy" /></p>

<p>In any of these proxy model, any traffic bound for the Service’s IP:Port is
proxied to an appropriate backend without the clients knowing anything
about Kubernetes or Services or Pods. Client-IP based session affinity
can be selected by setting <code>service.spec.sessionAffinity</code> to &ldquo;ClientIP&rdquo;
(the default is &ldquo;None&rdquo;), and you can set the max session sticky time by
setting the field <code>service.spec.sessionAffinityConfig.clientIP.timeoutSeconds</code>
if you have already set <code>service.spec.sessionAffinity</code> to &ldquo;ClientIP&rdquo;
(the default is “10800”).</p>

<h2 id="multi-port-services">Multi-Port Services</h2>

<p>Many <code>Services</code> need to expose more than one port.  For this case, Kubernetes
supports multiple port definitions on a <code>Service</code> object.  When using multiple
ports you must give all of your ports names, so that endpoints can be
disambiguated.  For example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>Service<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>selector:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>app:<span style="color:#bbb"> </span>MyApp<span style="color:#bbb">
</span><span style="color:#bbb">  </span>ports:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>http<span style="color:#bbb">
</span><span style="color:#bbb">    </span>protocol:<span style="color:#bbb"> </span>TCP<span style="color:#bbb">
</span><span style="color:#bbb">    </span>port:<span style="color:#bbb"> </span><span style="color:#666">80</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>targetPort:<span style="color:#bbb"> </span><span style="color:#666">9376</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>https<span style="color:#bbb">
</span><span style="color:#bbb">    </span>protocol:<span style="color:#bbb"> </span>TCP<span style="color:#bbb">
</span><span style="color:#bbb">    </span>port:<span style="color:#bbb"> </span><span style="color:#666">443</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>targetPort:<span style="color:#bbb"> </span><span style="color:#666">9377</span></code></pre></div>
<p>Note that the port names must only contain lowercase alphanumeric characters and <code>-</code>, and must begin &amp; end with an alphanumeric character. <code>123-abc</code> and <code>web</code> are valid, but <code>123_abc</code> and <code>-web</code> are not valid names.</p>

<h2 id="choosing-your-own-ip-address">Choosing your own IP address</h2>

<p>You can specify your own cluster IP address as part of a <code>Service</code> creation
request.  To do this, set the <code>.spec.clusterIP</code> field. For example, if you
already have an existing DNS entry that you wish to reuse, or legacy systems
that are configured for a specific IP address and difficult to re-configure.
The IP address that a user chooses must be a valid IP address and within the
<code>service-cluster-ip-range</code> CIDR range that is specified by flag to the API
server.  If the IP address value is invalid, the apiserver returns a 422 HTTP
status code to indicate that the value is invalid.</p>

<h3 id="why-not-use-round-robin-dns">Why not use round-robin DNS?</h3>

<p>A question that pops up every now and then is why we do all this stuff with
virtual IPs rather than just use standard round-robin DNS.  There are a few
reasons:</p>

<ul>
<li>There is a long history of DNS libraries not respecting DNS TTLs and
 caching the results of name lookups.</li>
<li>Many apps do DNS lookups once and cache the results.</li>
<li>Even if apps and libraries did proper re-resolution, the load of every
 client re-resolving DNS over and over would be difficult to manage.</li>
</ul>

<p>We try to discourage users from doing things that hurt themselves.  That said,
if enough people ask for this, we may implement it as an alternative.</p>

<h2 id="discovering-services">Discovering services</h2>

<p>Kubernetes supports 2 primary modes of finding a <code>Service</code> - environment
variables and DNS.</p>

<h3 id="environment-variables">Environment variables</h3>

<p>When a <code>Pod</code> is run on a <code>Node</code>, the kubelet adds a set of environment variables
for each active <code>Service</code>.  It supports both <a href="https://docs.docker.com/userguide/dockerlinks/" target="_blank">Docker links
compatible</a> variables (see
<a href="http://releases.k8s.io/master/pkg/kubelet/envvars/envvars.go#L49" target="_blank">makeLinkVariables</a>)
and simpler <code>{SVCNAME}_SERVICE_HOST</code> and <code>{SVCNAME}_SERVICE_PORT</code> variables,
where the Service name is upper-cased and dashes are converted to underscores.</p>

<p>For example, the Service <code>&quot;redis-master&quot;</code> which exposes TCP port 6379 and has been
allocated cluster IP address 10.0.0.11 produces the following environment
variables:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#b8860b">REDIS_MASTER_SERVICE_HOST</span><span style="color:#666">=</span><span style="color:#666">10</span>.0.0.11
<span style="color:#b8860b">REDIS_MASTER_SERVICE_PORT</span><span style="color:#666">=</span><span style="color:#666">6379</span>
<span style="color:#b8860b">REDIS_MASTER_PORT</span><span style="color:#666">=</span>tcp://10.0.0.11:6379
<span style="color:#b8860b">REDIS_MASTER_PORT_6379_TCP</span><span style="color:#666">=</span>tcp://10.0.0.11:6379
<span style="color:#b8860b">REDIS_MASTER_PORT_6379_TCP_PROTO</span><span style="color:#666">=</span>tcp
<span style="color:#b8860b">REDIS_MASTER_PORT_6379_TCP_PORT</span><span style="color:#666">=</span><span style="color:#666">6379</span>
<span style="color:#b8860b">REDIS_MASTER_PORT_6379_TCP_ADDR</span><span style="color:#666">=</span><span style="color:#666">10</span>.0.0.11</code></pre></div>
<p><em>This does imply an ordering requirement</em> - any <code>Service</code> that a <code>Pod</code> wants to
access must be created before the <code>Pod</code> itself, or else the environment
variables will not be populated.  DNS does not have this restriction.</p>

<h3 id="dns">DNS</h3>

<p>An optional (though strongly recommended) <a href="/docs/concepts/cluster-administration/addons/">cluster
add-on</a> is a DNS server.  The
DNS server watches the Kubernetes API for new <code>Services</code> and creates a set of
DNS records for each.  If DNS has been enabled throughout the cluster then all
<code>Pods</code> should be able to do name resolution of <code>Services</code> automatically.</p>

<p>For example, if you have a <code>Service</code> called <code>&quot;my-service&quot;</code> in a Kubernetes
<code>Namespace</code> called <code>&quot;my-ns&quot;</code>, a DNS record for <code>&quot;my-service.my-ns&quot;</code> is created.  <code>Pods</code>
which exist in the <code>&quot;my-ns&quot;</code> <code>Namespace</code> should be able to find it by simply doing
a name lookup for <code>&quot;my-service&quot;</code>.  <code>Pods</code> which exist in other <code>Namespaces</code> must
qualify the name as <code>&quot;my-service.my-ns&quot;</code>.  The result of these name lookups is the
cluster IP.</p>

<p>Kubernetes also supports DNS SRV (service) records for named ports.  If the
<code>&quot;my-service.my-ns&quot;</code> <code>Service</code> has a port named <code>&quot;http&quot;</code> with protocol <code>TCP</code>, you
can do a DNS SRV query for <code>&quot;_http._tcp.my-service.my-ns&quot;</code> to discover the port
number for <code>&quot;http&quot;</code>.</p>

<p>The Kubernetes DNS server is the only way to access services of type
<code>ExternalName</code>.  More information is available in the <a href="/docs/concepts/services-networking/dns-pod-service/">DNS Pods and
Services</a>.</p>

<h2 id="headless-services">Headless services</h2>

<p>Sometimes you don&rsquo;t need or want load-balancing and a single service IP.  In
this case, you can create &ldquo;headless&rdquo; services by specifying <code>&quot;None&quot;</code> for the
cluster IP (<code>.spec.clusterIP</code>).</p>

<p>This option allows developers to reduce coupling to the Kubernetes system by
allowing them freedom to do discovery their own way.  Applications can still use
a self-registration pattern and adapters for other discovery systems could easily
be built upon this API.</p>

<p>For such <code>Services</code>, a cluster IP is not allocated, kube-proxy does not handle
these services, and there is no load balancing or proxying done by the platform
for them. How DNS is automatically configured depends on whether the service has
selectors defined.</p>

<h3 id="with-selectors">With selectors</h3>

<p>For headless services that define selectors, the endpoints controller creates
<code>Endpoints</code> records in the API, and modifies the DNS configuration to return A
records (addresses) that point directly to the <code>Pods</code> backing the <code>Service</code>.</p>

<h3 id="without-selectors">Without selectors</h3>

<p>For headless services that do not define selectors, the endpoints controller does
not create <code>Endpoints</code> records. However, the DNS system looks for and configures
either:</p>

<ul>
<li>CNAME records for <a href="#externalname"><code>ExternalName</code></a>-type services.</li>
<li>A records for any <code>Endpoints</code> that share a name with the service, for all
other types.</li>
</ul>

<h2 id="publishing-services-service-types">Publishing services - service types</h2>

<p>For some parts of your application (e.g. frontends) you may want to expose a
Service onto an external (outside of your cluster) IP address.</p>

<p>Kubernetes <code>ServiceTypes</code> allow you to specify what kind of service you want.
The default is <code>ClusterIP</code>.</p>

<p><code>Type</code> values and their behaviors are:</p>

<ul>
<li><code>ClusterIP</code>: Exposes the service on a cluster-internal IP. Choosing this value
 makes the service only reachable from within the cluster. This is the
 default <code>ServiceType</code>.</li>
<li><a href="#nodeport"><code>NodePort</code></a>: Exposes the service on each Node&rsquo;s IP at a static port
 (the <code>NodePort</code>). A <code>ClusterIP</code> service, to which the <code>NodePort</code> service will
 route, is automatically created.  You&rsquo;ll be able to contact the <code>NodePort</code> service,
 from outside the cluster,
 by requesting <code>&lt;NodeIP&gt;:&lt;NodePort&gt;</code>.</li>
<li><a href="#loadbalancer"><code>LoadBalancer</code></a>: Exposes the service externally using a cloud
 provider&rsquo;s load balancer. <code>NodePort</code> and <code>ClusterIP</code> services, to which the external
 load balancer will route, are automatically created.</li>
<li><a href="#externalname"><code>ExternalName</code></a>: Maps the service to the contents of the
 <code>externalName</code> field (e.g. <code>foo.bar.example.com</code>), by returning a <code>CNAME</code> record
 with its value. No proxying of any kind is set up. This requires version 1.7 or
 higher of <code>kube-dns</code>.</li>
</ul>

<h3 id="nodeport">Type NodePort</h3>

<p>If you set the <code>type</code> field to <code>NodePort</code>, the Kubernetes master will
allocate a port from a range specified by <code>--service-node-port-range</code> flag (default: 30000-32767), and each
Node will proxy that port (the same port number on every Node) into your <code>Service</code>.
That port will be reported in your <code>Service</code>&rsquo;s <code>.spec.ports[*].nodePort</code> field.</p>

<p>If you want to specify particular IP(s) to proxy the port, you can set the <code>--nodeport-addresses</code> flag in kube-proxy to particular IP block(s) (which is supported since Kubernetes v1.10). A comma-delimited list of IP blocks (e.g. 10.0.0.0/8, 1.2.3.4/32) is used to filter addresses local to this node. For example, if you start kube-proxy with flag <code>--nodeport-addresses=127.0.0.0/8</code>, kube-proxy will select only the loopback interface for NodePort Services. The <code>--nodeport-addresses</code> is defaulted to empty (<code>[]</code>), which means select all available interfaces and is in compliance with current NodePort behaviors.</p>

<p>If you want a specific port number, you can specify a value in the <code>nodePort</code>
field, and the system will allocate you that port or else the API transaction
will fail (i.e. you need to take care about possible port collisions yourself).
The value you specify must be in the configured range for node ports.</p>

<p>This gives developers the freedom to set up their own load balancers, to
configure environments that are not fully supported by Kubernetes, or
even to just expose one or more nodes&rsquo; IPs directly.</p>

<p>Note that this Service will be visible as both <code>&lt;NodeIP&gt;:spec.ports[*].nodePort</code>
and <code>.spec.clusterIP:spec.ports[*].port</code>. (If the <code>--nodeport-addresses</code> flag in kube-proxy is set, <NodeIP> would be filtered NodeIP(s).)</p>

<h3 id="loadbalancer">Type LoadBalancer</h3>

<p>On cloud providers which support external load balancers, setting the <code>type</code>
field to <code>LoadBalancer</code> will provision a load balancer for your <code>Service</code>.
The actual creation of the load balancer happens asynchronously, and
information about the provisioned balancer will be published in the <code>Service</code>&rsquo;s
<code>.status.loadBalancer</code> field.  For example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>Service<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>selector:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>app:<span style="color:#bbb"> </span>MyApp<span style="color:#bbb">
</span><span style="color:#bbb">  </span>ports:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>protocol:<span style="color:#bbb"> </span>TCP<span style="color:#bbb">
</span><span style="color:#bbb">    </span>port:<span style="color:#bbb"> </span><span style="color:#666">80</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>targetPort:<span style="color:#bbb"> </span><span style="color:#666">9376</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>clusterIP:<span style="color:#bbb"> </span><span style="color:#666">10.0</span>.<span style="color:#666">171.239</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>loadBalancerIP:<span style="color:#bbb"> </span><span style="color:#666">78.11</span>.<span style="color:#666">24.19</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>type:<span style="color:#bbb"> </span>LoadBalancer<span style="color:#bbb">
</span><span style="color:#bbb"></span>status:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>loadBalancer:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>ingress:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>ip:<span style="color:#bbb"> </span><span style="color:#666">146.148</span>.<span style="color:#666">47.155</span></code></pre></div>
<p>Traffic from the external load balancer will be directed at the backend <code>Pods</code>,
though exactly how that works depends on the cloud provider. Some cloud providers allow
the <code>loadBalancerIP</code> to be specified. In those cases, the load-balancer will be created
with the user-specified <code>loadBalancerIP</code>. If the <code>loadBalancerIP</code> field is not specified,
an ephemeral IP will be assigned to the loadBalancer. If the <code>loadBalancerIP</code> is specified, but the
cloud provider does not support the feature, the field will be ignored.</p>

<p><strong>Special notes for Azure</strong>: To use user-specified public type <code>loadBalancerIP</code>, a static type
public IP address resource needs to be created first, and it should be in the same resource
group of the other automatically created resources of the cluster. For example, <code>MC_myResourceGroup_myAKSCluster_eastus</code>. Specify the assigned IP address as loadBalancerIP. Ensure that you have updated the securityGroupName in the cloud provider configuration file. For information about troubleshooting <code>CreatingLoadBalancerFailed</code> permission issues see, <a href="https://docs.microsoft.com/en-us/azure/aks/static-ip" target="_blank">Use a static IP address with the Azure Kubernetes Service (AKS) load balancer</a> or <a href="https://github.com/Azure/AKS/issues/357" target="_blank">CreatingLoadBalancerFailed on AKS cluster with advanced networking</a>.</p>

<blockquote class="note">
  <div><strong>Note:</strong> The support of SCTP in the cloud provider&rsquo;s load balancer is up to the cloud provider&rsquo;s
load balancer implementation. If SCTP is not supported by the cloud provider&rsquo;s load balancer the
Service creation request is accepted but the creation of the load balancer fails.</div>
</blockquote>

<h4 id="internal-load-balancer">Internal load balancer</h4>

<p>In a mixed environment it is sometimes necessary to route traffic from services inside the same VPC.</p>

<p>In a split-horizon DNS environment you would need two services to be able to route both external and internal traffic to your endpoints.</p>

<p>This can be achieved by adding the following annotations to the service based on cloud provider.</p>

<div id="service-tabs">
<ul>
    
      
  <li><a href="#service-tabs-0">Default</a></li>

      
  <li><a href="#service-tabs-1">GCP</a></li>

      
  <li><a href="#service-tabs-2">AWS</a></li>

      
  <li><a href="#service-tabs-3">Azure</a></li>

      
  <li><a href="#service-tabs-4">OpenStack</a></li>

      
  <li><a href="#service-tabs-5">Baidu Cloud</a></li>

</ul>


<div id="service-tabs-0">
    
        <p>Select one of the tabs.</p>

    
</div>

<div id="service-tabs-1">
    
        <div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">[...]<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">    </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>cloud.google.com/load-balancer-type:<span style="color:#bbb"> </span><span style="color:#b44">&#34;Internal&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>[...]</code></pre></div>
<p>Use <code>cloud.google.com/load-balancer-type: &quot;internal&quot;</code> for masters with version 1.7.0 to 1.7.3.
For more information, see the <a href="https://cloud.google.com/kubernetes-engine/docs/internal-load-balancing" target="_blank">docs</a>.</p>

    
</div>

<div id="service-tabs-2">
    
        <div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">[...]<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">    </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-internal:<span style="color:#bbb"> </span><span style="color:#666">0.0</span>.<span style="color:#666">0.0</span>/<span style="color:#666">0</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>[...]</code></pre></div>
    

<p></div></p>

<div id="service-tabs-3">
    
        <div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">[...]<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">    </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/azure-load-balancer-internal:<span style="color:#bbb"> </span><span style="color:#b44">&#34;true&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>[...]</code></pre></div>
    

<p></div></p>

<div id="service-tabs-4">
    
        <div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">[...]<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">    </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/openstack-internal-load-balancer:<span style="color:#bbb"> </span><span style="color:#b44">&#34;true&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>[...]</code></pre></div>
    

<p></div></p>

<div id="service-tabs-5">
    
        <div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">[...]<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">    </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/cce-load-balancer-internal-vpc:<span style="color:#bbb"> </span><span style="color:#b44">&#34;true&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>[...]</code></pre></div>
    

<p></div></p>

<p></div></p>

<script>$(function(){$("#service-tabs").tabs();});</script>

<h4 id="ssl-support-on-aws">SSL support on AWS</h4>

<p>For partial SSL support on clusters running on AWS, starting with 1.3 three
annotations can be added to a <code>LoadBalancer</code> service:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">  </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>service.beta.kubernetes.io/aws-load-balancer-ssl-cert:<span style="color:#bbb"> </span>arn:aws:acm:us-east-<span style="color:#666">1</span>:<span style="color:#666">123456789012</span>:certificate/<span style="color:#666">12345678</span>-<span style="color:#666">1234</span>-<span style="color:#666">1234</span>-<span style="color:#666">1234</span>-<span style="color:#666">123456789012</span></code></pre></div>
<p>The first specifies the ARN of the certificate to use. It can be either a
certificate from a third party issuer that was uploaded to IAM or one created
within AWS Certificate Manager.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">  </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>service.beta.kubernetes.io/aws-load-balancer-backend-protocol:<span style="color:#bbb"> </span>(https|http|ssl|tcp)</code></pre></div>
<p>The second annotation specifies which protocol a pod speaks. For HTTPS and
SSL, the ELB will expect the pod to authenticate itself over the encrypted
connection.</p>

<p>HTTP and HTTPS will select layer 7 proxying: the ELB will terminate
the connection with the user, parse headers and inject the <code>X-Forwarded-For</code>
header with the user&rsquo;s IP address (pods will only see the IP address of the
ELB at the other end of its connection) when forwarding requests.</p>

<p>TCP and SSL will select layer 4 proxying: the ELB will forward traffic without
modifying the headers.</p>

<p>In a mixed-use environment where some ports are secured and others are left unencrypted,
the following annotations may be used:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#bbb">    </span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">      </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-backend-protocol:<span style="color:#bbb"> </span>http<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-ssl-ports:<span style="color:#bbb"> </span><span style="color:#b44">&#34;443,8443&#34;</span></code></pre></div>
<p>In the above example, if the service contained three ports, <code>80</code>, <code>443</code>, and
<code>8443</code>, then <code>443</code> and <code>8443</code> would use the SSL certificate, but <code>80</code> would just
be proxied HTTP.</p>

<p>Beginning in 1.9, services can use <a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-security-policy-table.html" target="_blank">predefined AWS SSL policies</a>
for any HTTPS or SSL listeners. To see which policies are available for use, run
the awscli command:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">aws elb describe-load-balancer-policies --query <span style="color:#b44">&#39;PolicyDescriptions[].PolicyName&#39;</span></code></pre></div>
<p>Any one of those policies can then be specified using the
&ldquo;<code>service.beta.kubernetes.io/aws-load-balancer-ssl-negotiation-policy</code>&ldquo;
annotation, for example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#bbb">    </span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">      </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-ssl-negotiation-policy:<span style="color:#bbb"> </span><span style="color:#b44">&#34;ELBSecurityPolicy-TLS-1-2-2017-01&#34;</span></code></pre></div>
<h4 id="proxy-protocol-support-on-aws">PROXY protocol support on AWS</h4>

<p>To enable <a href="https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt" target="_blank">PROXY protocol</a>
support for clusters running on AWS, you can use the following service
annotation:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#bbb">    </span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">      </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-proxy-protocol:<span style="color:#bbb"> </span><span style="color:#b44">&#34;*&#34;</span></code></pre></div>
<p>Since version 1.3.0 the use of this annotation applies to all ports proxied by the ELB
and cannot be configured otherwise.</p>

<h4 id="elb-access-logs-on-aws">ELB Access Logs on AWS</h4>

<p>There are several annotations to manage access logs for ELB services on AWS.</p>

<p>The annotation <code>service.beta.kubernetes.io/aws-load-balancer-access-log-enabled</code>
controls whether access logs are enabled.</p>

<p>The annotation <code>service.beta.kubernetes.io/aws-load-balancer-access-log-emit-interval</code>
controls the interval in minutes for publishing the access logs. You can specify
an interval of either 5 or 60.</p>

<p>The annotation <code>service.beta.kubernetes.io/aws-load-balancer-access-log-s3-bucket-name</code>
controls the name of the Amazon S3 bucket where load balancer access logs are
stored.</p>

<p>The annotation <code>service.beta.kubernetes.io/aws-load-balancer-access-log-s3-bucket-prefix</code>
specifies the logical hierarchy you created for your Amazon S3 bucket.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#bbb">    </span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">      </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-access-log-enabled:<span style="color:#bbb"> </span><span style="color:#b44">&#34;true&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># Specifies whether access logs are enabled for the load balancer</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-access-log-emit-interval:<span style="color:#bbb"> </span><span style="color:#b44">&#34;60&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># The interval for publishing the access logs. You can specify an interval of either 5 or 60 (minutes).</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-access-log-s3-bucket-name:<span style="color:#bbb"> </span><span style="color:#b44">&#34;my-bucket&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># The name of the Amazon S3 bucket where the access logs are stored</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-access-log-s3-bucket-prefix:<span style="color:#bbb"> </span><span style="color:#b44">&#34;my-bucket-prefix/prod&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># The logical hierarchy you created for your Amazon S3 bucket, for example `my-bucket-prefix/prod`</span></code></pre></div>
<h4 id="connection-draining-on-aws">Connection Draining on AWS</h4>

<p>Connection draining for Classic ELBs can be managed with the annotation
<code>service.beta.kubernetes.io/aws-load-balancer-connection-draining-enabled</code> set
to the value of <code>&quot;true&quot;</code>. The annotation
<code>service.beta.kubernetes.io/aws-load-balancer-connection-draining-timeout</code> can
also be used to set maximum time, in seconds, to keep the existing connections open before deregistering the instances.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#bbb">    </span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">      </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-connection-draining-enabled:<span style="color:#bbb"> </span><span style="color:#b44">&#34;true&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-connection-draining-timeout:<span style="color:#bbb"> </span><span style="color:#b44">&#34;60&#34;</span></code></pre></div>
<h4 id="other-elb-annotations">Other ELB annotations</h4>

<p>There are other annotations to manage Classic Elastic Load Balancers that are described below.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#bbb">    </span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">      </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-connection-idle-timeout:<span style="color:#bbb"> </span><span style="color:#b44">&#34;60&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># The time, in seconds, that the connection is allowed to be idle (no data has been sent over the connection) before it is closed by the load balancer</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled:<span style="color:#bbb"> </span><span style="color:#b44">&#34;true&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># Specifies whether cross-zone load balancing is enabled for the load balancer</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-additional-resource-tags:<span style="color:#bbb"> </span><span style="color:#b44">&#34;environment=prod,owner=devops&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># A comma-separated list of key-value pairs which will be recorded as</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># additional tags in the ELB.</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-healthcheck-healthy-threshold:<span style="color:#bbb"> </span><span style="color:#b44">&#34;&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># The number of successive successful health checks required for a backend to</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># be considered healthy for traffic. Defaults to 2, must be between 2 and 10</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-healthcheck-unhealthy-threshold:<span style="color:#bbb"> </span><span style="color:#b44">&#34;3&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># The number of unsuccessful health checks required for a backend to be</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># considered unhealthy for traffic. Defaults to 6, must be between 2 and 10</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-healthcheck-interval:<span style="color:#bbb"> </span><span style="color:#b44">&#34;20&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># The approximate interval, in seconds, between health checks of an</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># individual instance. Defaults to 10, must be between 5 and 300</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-healthcheck-timeout:<span style="color:#bbb"> </span><span style="color:#b44">&#34;5&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># The amount of time, in seconds, during which no response means a failed</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># health check. This value must be less than the service.beta.kubernetes.io/aws-load-balancer-healthcheck-interval</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># value. Defaults to 5, must be between 2 and 60</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-extra-security-groups:<span style="color:#bbb"> </span><span style="color:#b44">&#34;sg-53fae93f,sg-42efd82e&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># A list of additional security groups to be added to ELB</span></code></pre></div>
<h4 id="network-load-balancer-support-on-aws-alpha">Network Load Balancer support on AWS [alpha]</h4>

<blockquote class="warning">
  <div><strong>Warning:</strong> This is an alpha feature and not recommended for production clusters yet.</div>
</blockquote>

<p>Starting in version 1.9.0, Kubernetes supports Network Load Balancer (NLB). To
use a Network Load Balancer on AWS, use the annotation <code>service.beta.kubernetes.io/aws-load-balancer-type</code>
with the value set to <code>nlb</code>.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#bbb">    </span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">      </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>service.beta.kubernetes.io/aws-load-balancer-type:<span style="color:#bbb"> </span><span style="color:#b44">&#34;nlb&#34;</span></code></pre></div>
<p>Unlike Classic Elastic Load Balancers, Network Load Balancers (NLBs) forward the
client&rsquo;s IP through to the node. If a service&rsquo;s <code>.spec.externalTrafficPolicy</code> is
set to <code>Cluster</code>, the client&rsquo;s IP address will not be propagated to the end
pods.</p>

<p>By setting <code>.spec.externalTrafficPolicy</code> to <code>Local</code>, client IP addresses will be
propagated to the end pods, but this could result in uneven distribution of
traffic. Nodes without any pods for a particular LoadBalancer service will fail
the NLB Target Group&rsquo;s health check on the auto-assigned
<code>.spec.healthCheckNodePort</code> and not receive any traffic.</p>

<p>In order to achieve even traffic, either use a DaemonSet, or specify a
<a href="/docs/concepts/configuration/assign-pod-node/#inter-pod-affinity-and-anti-affinity-beta-feature">pod anti-affinity</a>
to not locate pods on the same node.</p>

<p>NLB can also be used with the <a href="/docs/concepts/services-networking/service/#internal-load-balancer">internal load balancer</a>
annotation.</p>

<p>In order for client traffic to reach instances behind an NLB, the Node security
groups are modified with the following IP rules:</p>

<table>
<thead>
<tr>
<th>Rule</th>
<th>Protocol</th>
<th>Port(s)</th>
<th>IpRange(s)</th>
<th>IpRange Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>Health Check</td>
<td>TCP</td>
<td>NodePort(s) (<code>.spec.healthCheckNodePort</code> for <code>.spec.externalTrafficPolicy = Local</code>)</td>
<td>VPC CIDR</td>
<td>kubernetes.io/rule/nlb/health=&lt;loadBalancerName&gt;</td>
</tr>

<tr>
<td>Client Traffic</td>
<td>TCP</td>
<td>NodePort(s)</td>
<td><code>.spec.loadBalancerSourceRanges</code> (defaults to <code>0.0.0.0/0</code>)</td>
<td>kubernetes.io/rule/nlb/client=&lt;loadBalancerName&gt;</td>
</tr>

<tr>
<td>MTU Discovery</td>
<td>ICMP</td>
<td>3,4</td>
<td><code>.spec.loadBalancerSourceRanges</code> (defaults to <code>0.0.0.0/0</code>)</td>
<td>kubernetes.io/rule/nlb/mtu=&lt;loadBalancerName&gt;</td>
</tr>
</tbody>
</table>

<p>Be aware that if <code>.spec.loadBalancerSourceRanges</code> is not set, Kubernetes will
allow traffic from <code>0.0.0.0/0</code> to the Node Security Group(s). If nodes have
public IP addresses, be aware that non-NLB traffic can also reach all instances
in those modified security groups.</p>

<p>In order to limit which client IP&rsquo;s can access the Network Load Balancer,
specify <code>loadBalancerSourceRanges</code>.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>loadBalancerSourceRanges:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span><span style="color:#b44">&#34;143.231.0.0/16&#34;</span></code></pre></div>
<blockquote class="note">
  <div><strong>Note:</strong> NLB only works with certain instance classes, see the <a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/network/target-group-register-targets.html#register-deregister-targets" target="_blank">AWS documentation</a>
for supported instance types.</div>
</blockquote>

<h3 id="externalname">Type ExternalName</h3>

<p>Services of type ExternalName map a service to a DNS name, not to a typical selector such as
<code>my-service</code> or <code>cassandra</code>. You specify these services with the <code>spec.externalName</code> parameter.</p>

<p>This Service definition, for example, maps
the <code>my-service</code> Service in the <code>prod</code> namespace to <code>my.database.example.com</code>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>Service<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb">  </span>namespace:<span style="color:#bbb"> </span>prod<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>type:<span style="color:#bbb"> </span>ExternalName<span style="color:#bbb">
</span><span style="color:#bbb">  </span>externalName:<span style="color:#bbb"> </span>my.database.example.com</code></pre></div>
<blockquote class="note">
  <div><strong>Note:</strong> ExternalName accepts an IPv4 address string, but as a DNS name comprised of digits, not as an IP address. ExternalNames that resemble IPv4 addresses are not resolved by CoreDNS or ingress-nginx because ExternalName
is intended to specify a canonical DNS name. To hardcode an IP address, consider headless services.</div>
</blockquote>

<p>When looking up the host <code>my-service.prod.svc.cluster.local</code>, the cluster DNS service
will return a <code>CNAME</code> record with the value <code>my.database.example.com</code>. Accessing
<code>my-service</code> works in the same way as other Services but with the crucial
difference that redirection happens at the DNS level rather than via proxying or
forwarding. Should you later decide to move your database into your cluster, you
can start its pods, add appropriate selectors or endpoints, and change the
service&rsquo;s <code>type</code>.</p>

<blockquote class="note">
  <div><strong>Note:</strong> This section is indebted to the <a href="https://akomljen.com/kubernetes-tips-part-1/" target="_blank">Kubernetes Tips - Part
1</a> blog post from <a href="https://akomljen.com/" target="_blank">Alen Komljen</a>.</div>
</blockquote>

<h3 id="external-ips">External IPs</h3>

<p>If there are external IPs that route to one or more cluster nodes, Kubernetes services can be exposed on those
<code>externalIPs</code>. Traffic that ingresses into the cluster with the external IP (as destination IP), on the service port,
will be routed to one of the service endpoints. <code>externalIPs</code> are not managed by Kubernetes and are the responsibility
of the cluster administrator.</p>

<p>In the <code>ServiceSpec</code>, <code>externalIPs</code> can be specified along with any of the <code>ServiceTypes</code>.
In the example below, &ldquo;<code>my-service</code>&rdquo; can be accessed by clients on &ldquo;<code>80.11.12.10:80</code>&rdquo;&rdquo; (<code>externalIP:port</code>)</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">kind:<span style="color:#bbb"> </span>Service<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>my-service<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>selector:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>app:<span style="color:#bbb"> </span>MyApp<span style="color:#bbb">
</span><span style="color:#bbb">  </span>ports:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>http<span style="color:#bbb">
</span><span style="color:#bbb">    </span>protocol:<span style="color:#bbb"> </span>TCP<span style="color:#bbb">
</span><span style="color:#bbb">    </span>port:<span style="color:#bbb"> </span><span style="color:#666">80</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>targetPort:<span style="color:#bbb"> </span><span style="color:#666">9376</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>externalIPs:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span><span style="color:#666">80.11</span>.<span style="color:#666">12.10</span></code></pre></div>
<h2 id="shortcomings">Shortcomings</h2>

<p>Using the userspace proxy for VIPs will work at small to medium scale, but will
not scale to very large clusters with thousands of Services.  See <a href="http://issue.k8s.io/1107" target="_blank">the original
design proposal for portals</a> for more details.</p>

<p>Using the userspace proxy obscures the source-IP of a packet accessing a <code>Service</code>.
This makes some kinds of firewalling impossible.  The iptables proxier does not
obscure in-cluster source IPs, but it does still impact clients coming through
a load-balancer or node-port.</p>

<p>The <code>Type</code> field is designed as nested functionality - each level adds to the
previous.  This is not strictly required on all cloud providers (e.g. Google Compute Engine does
not need to allocate a <code>NodePort</code> to make <code>LoadBalancer</code> work, but AWS does)
but the current API requires it.</p>

<h2 id="future-work">Future work</h2>

<p>In the future we envision that the proxy policy can become more nuanced than
simple round robin balancing, for example master-elected or sharded.  We also
envision that some <code>Services</code> will have &ldquo;real&rdquo; load balancers, in which case the
VIP will simply transport the packets there.</p>

<p>We intend to improve our support for L7 (HTTP) <code>Services</code>.</p>

<p>We intend to have more flexible ingress modes for <code>Services</code> which encompass
the current <code>ClusterIP</code>, <code>NodePort</code>, and <code>LoadBalancer</code> modes and more.</p>

<h2 id="the-gory-details-of-virtual-ips">The gory details of virtual IPs</h2>

<p>The previous information should be sufficient for many people who just want to
use <code>Services</code>.  However, there is a lot going on behind the scenes that may be
worth understanding.</p>

<h3 id="avoiding-collisions">Avoiding collisions</h3>

<p>One of the primary philosophies of Kubernetes is that users should not be
exposed to situations that could cause their actions to fail through no fault
of their own.  In this situation, we are looking at network ports - users
should not have to choose a port number if that choice might collide with
another user.  That is an isolation failure.</p>

<p>In order to allow users to choose a port number for their <code>Services</code>, we must
ensure that no two <code>Services</code> can collide.  We do that by allocating each
<code>Service</code> its own IP address.</p>

<p>To ensure each service receives a unique IP, an internal allocator atomically
updates a global allocation map in etcd prior to creating each service. The map object
must exist in the registry for services to get IPs, otherwise creations will
fail with a message indicating an IP could not be allocated. A background
controller is responsible for creating that map (to migrate from older versions
of Kubernetes that used in memory locking) as well as checking for invalid
assignments due to administrator intervention and cleaning up any IPs
that were allocated but which no service currently uses.</p>

<h3 id="ips-and-vips">IPs and VIPs</h3>

<p>Unlike <code>Pod</code> IP addresses, which actually route to a fixed destination,
<code>Service</code> IPs are not actually answered by a single host.  Instead, we use
<code>iptables</code> (packet processing logic in Linux) to define virtual IP addresses
which are transparently redirected as needed.  When clients connect to the
VIP, their traffic is automatically transported to an appropriate endpoint.
The environment variables and DNS for <code>Services</code> are actually populated in
terms of the <code>Service</code>&rsquo;s VIP and port.</p>

<p>We support three proxy modes - userspace, iptables and ipvs which operate
slightly differently.</p>

<h4 id="userspace">Userspace</h4>

<p>As an example, consider the image processing application described above.
When the backend <code>Service</code> is created, the Kubernetes master assigns a virtual
IP address, for example 10.0.0.1.  Assuming the <code>Service</code> port is 1234, the
<code>Service</code> is observed by all of the <code>kube-proxy</code> instances in the cluster.
When a proxy sees a new <code>Service</code>, it opens a new random port, establishes an
iptables redirect from the VIP to this new port, and starts accepting
connections on it.</p>

<p>When a client connects to the VIP the iptables rule kicks in, and redirects
the packets to the <code>Service proxy</code>&rsquo;s own port.  The <code>Service proxy</code> chooses a
backend, and starts proxying traffic from the client to the backend.</p>

<p>This means that <code>Service</code> owners can choose any port they want without risk of
collision.  Clients can simply connect to an IP and port, without being aware
of which <code>Pods</code> they are actually accessing.</p>

<h4 id="iptables">Iptables</h4>

<p>Again, consider the image processing application described above.
When the backend <code>Service</code> is created, the Kubernetes master assigns a virtual
IP address, for example 10.0.0.1.  Assuming the <code>Service</code> port is 1234, the
<code>Service</code> is observed by all of the <code>kube-proxy</code> instances in the cluster.
When a proxy sees a new <code>Service</code>, it installs a series of iptables rules which
redirect from the VIP to per-<code>Service</code> rules.  The per-<code>Service</code> rules link to
per-<code>Endpoint</code> rules which redirect (Destination NAT) to the backends.</p>

<p>When a client connects to the VIP the iptables rule kicks in.  A backend is
chosen (either based on session affinity or randomly) and packets are
redirected to the backend.  Unlike the userspace proxy, packets are never
copied to userspace, the kube-proxy does not have to be running for the VIP to
work, and the client IP is not altered.</p>

<p>This same basic flow executes when traffic comes in through a node-port or
through a load-balancer, though in those cases the client IP does get altered.</p>

<h4 id="ipvs">Ipvs</h4>

<p>Iptables operations slow down dramatically in large scale cluster e.g 10,000 Services. IPVS is designed for load balancing and based on in-kernel hash tables. So we can achieve performance consistency in large number of services from IPVS-based kube-proxy. Meanwhile, IPVS-based kube-proxy has more sophisticated load balancing algorithms (least conns, locality, weighted, persistence).</p>

<h2 id="api-object">API Object</h2>

<p>Service is a top-level resource in the Kubernetes REST API. More details about the
API object can be found at:
<a href="/docs/reference/generated/kubernetes-api/v1.13/#service-v1-core">Service API object</a>.</p>

<h2 id="protocol-support">Supported protocols</h2>

<h3 id="tcp">TCP</h3>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.0</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>stable</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="stable">
This feature is <em>stable</em>, meaning:</p>

<ul>
<li>The version name is vX where X is an integer.</li>
<li>Stable versions of features will appear in released software for many subsequent versions.</li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>You can use TCP for any kind of service, and it&rsquo;s the default network protocol.</p>

<h3 id="udp">UDP</h3>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.0</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>stable</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="stable">
This feature is <em>stable</em>, meaning:</p>

<ul>
<li>The version name is vX where X is an integer.</li>
<li>Stable versions of features will appear in released software for many subsequent versions.</li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>You can use UDP for most services. For type=LoadBalancer services, UDP support
depends on the cloud provider offering this facility.</p>

<h3 id="http">HTTP</h3>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.1</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>stable</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="stable">
This feature is <em>stable</em>, meaning:</p>

<ul>
<li>The version name is vX where X is an integer.</li>
<li>Stable versions of features will appear in released software for many subsequent versions.</li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>If your cloud provider supports it, you can use a Service in LoadBalancer mode
to set up external HTTP / HTTPS reverse proxying, forwarded to the Endpoints
of the Service.</p>

<blockquote class="note">
  <div><strong>Note:</strong> You can also use <a class='glossary-tooltip' href='/docs/concepts/services-networking/ingress/' target='_blank'>Ingress<span class='tooltip-text'>An API object that manages external access to the services in a cluster, typically HTTP.</span>
</a> in place of Service
to expose HTTP / HTTPS services.</div>
</blockquote>

<h3 id="proxy-protocol">PROXY protocol</h3>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.1</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>stable</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="stable">
This feature is <em>stable</em>, meaning:</p>

<ul>
<li>The version name is vX where X is an integer.</li>
<li>Stable versions of features will appear in released software for many subsequent versions.</li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>If your cloud provider supports it (eg, <a href="https://kubernetes.io/docs/concepts/cluster-administration/cloud-providers/#aws" target="_blank">AWS</a>),
you can use a Service in LoadBalancer mode to configure a load balancer outside
of Kubernetes itself, that will forward connections prefixed with
<a href="https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt" target="_blank">PROXY protocol</a>.</p>

<p>The load balancer will send an initial series of octets describing the
incoming connection, similar to this example</p>

<pre><code>PROXY TCP4 192.0.2.202 10.0.42.7 12345 7\r\n
</code></pre>

<p>followed by the data from the client.</p>

<h3 id="sctp">SCTP</h3>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.12</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>alpha</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="alpha">
This feature is currently in a <em>alpha</em> state, meaning:</p>

<ul>
<li>The version names contain alpha (e.g. v1alpha1).</li>
<li>Might be buggy. Enabling the feature may expose bugs. Disabled by default.</li>
<li>Support for feature may be dropped at any time without notice.</li>
<li>The API may change in incompatible ways in a later software release without notice.</li>
<li>Recommended for use only in short-lived testing clusters, due to increased risk of bugs and lack of long-term support.</li>
</ul>

</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>Kubernetes supports SCTP as a <code>protocol</code> value in <code>Service</code>, <code>Endpoint</code>, <code>NetworkPolicy</code> and <code>Pod</code> definitions as an alpha feature. To enable this feature, the cluster administrator needs to enable the <code>SCTPSupport</code> feature gate on the apiserver, for example, <code>“--feature-gates=SCTPSupport=true,...”</code>. When the feature gate is enabled, users can set the <code>protocol</code> field of a <code>Service</code>, <code>Endpoint</code>, <code>NetworkPolicy</code> and <code>Pod</code> to <code>SCTP</code>. Kubernetes sets up the network accordingly for the SCTP associations, just like it does for TCP connections.</p>

<h4 id="caveat-sctp-overview">Warnings</h4>

<h5 id="caveat-sctp-multihomed">Support for multihomed SCTP associations</h5>

<p>The support of multihomed SCTP associations requires that the CNI plugin can support the assignment of multiple interfaces and IP addresses to a <code>Pod</code>.</p>

<p>NAT for multihomed SCTP associations requires special logic in the corresponding kernel modules.</p>

<h5 id="caveat-sctp-loadbalancer-service-type">Service with type=LoadBalancer</h5>

<p>A <code>Service</code> with <code>type</code> LoadBalancer and <code>protocol</code> SCTP can be created only if the cloud provider&rsquo;s load balancer implementation supports SCTP as a protocol. Otherwise the <code>Service</code> creation request is rejected. The current set of cloud load balancer providers (<code>Azure</code>, <code>AWS</code>, <code>CloudStack</code>, <code>GCE</code>, <code>OpenStack</code>) do not support SCTP.</p>

<h5 id="caveat-sctp-windows-os">Windows</h5>

<p>SCTP is not supported on Windows based nodes.</p>

<h5 id="caveat-sctp-kube-proxy-userspace">Userspace kube-proxy</h5>

<p>The kube-proxy does not support the management of SCTP associations when it is in userspace mode.</p>












<h2 id="what-s-next">What&#39;s next</h2>
<p>Read <a href="/docs/tasks/access-application-cluster/connecting-frontend-backend/">Connecting a Front End to a Back End Using a Service</a>.</p>






<nav class="pagination" style="font-size: 16px; font-weight: bold"><a class="nav nav-prev" href="/docs/concepts/services-networking/" title="Services, Load Balancing, and Networking"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Services, Load Balancing, and Networking</a>
<a class="nav nav-next" style="float:right"  href="/docs/concepts/services-networking/dns-pod-service/" title="DNS for Services and Pods">Next - DNS for Services and Pods <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav>


  
  <h2>Feedback</h2>
  <p class="feedback--prompt">Was this page helpful? </p>
  <button class="button feedback--yes">Yes</button>
  <button class="button feedback--no">No</button>
  <p class="feedback--response feedback--response__hidden">
    Thanks for the feedback. If you have a specific, answerable question about how to use Kubernetes,
    ask it on <a target="_blank" rel="noopener"
    href="https://stackoverflow.com/questions/tagged/kubernetes">Stack Overflow</a>. Open
    an issue in the GitHub repo if you want to <a class="feedback--link" target="_blank" rel="noopener"
    href="https://github.com/kubernetes/website/issues/new?title=Issue%20with%20k8s.io">report a problem</a> or
    <a class="feedback--link" target="_blank" rel="noopener"
    href="https://github.com/kubernetes/website/issues/new?title=Improvement%20for%20k8s.io">suggest an improvement</a>.
  </p>
  <script>
    const yes = document.querySelector('.feedback--yes');
    const no = document.querySelector('.feedback--no');
    document.querySelectorAll('.feedback--link').forEach(link => {
      link.href = link.href + window.location.pathname;
    });
    const sendFeedback = (value) => {
      if (!gtag) { console.log('!gtag'); }
      gtag('event', 'click', {
        'event_category': 'Helpful',
        'event_label': window.location.pathname,
        value
      });
    };
    const disableButtons = () => {
      yes.disabled = true;
      yes.classList.add('feedback--button__disabled');
      no.disabled = true;
      no.classList.add('feedback--button__disabled');
    };
    yes.addEventListener('click', () => {
      sendFeedback(1);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
    no.addEventListener('click', () => {
      sendFeedback(0);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
  </script>


  <div id="pre-footer"> 
  <hr />

  <div class="issue-button-container">
    <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs%5cconcepts%5cservices-networking%5cservice.md?pixel" alt="Analytics" /></a></p>
    
    
    <script type="text/javascript">
    PDRTJS_settings_8345992 = {
    "id" : "8345992",
    "unique_id" : "\/docs\/concepts\/services-networking\/service\/",
    "title" : "Services",
    "permalink" : "https:\/\/qinlj.github.io\/docs\/concepts\/services-networking\/service\/"
    };
    (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
    </script>
    <a href="" onclick="window.open('https://github.com/kubernetes/website/issues/new?title=Issue%20with%20' +
    'k8s.io'+window.location.pathname)" class="button issue">Create an Issue</a>
    
    
    
    <a href="https://github.com/kubernetes/website/edit/master/content/en/docs%5cconcepts%5cservices-networking%5cservice.md" class="button issue">Edit This Page</a>
    
  </div>
  

  <div id="lastedit" class="lastedit issue-button-container">
    Page last modified on February 28, 2019 at 4:25 AM PST by
    <a href="https://github.com/kubernetes/website/commit/b8ad490a8090a20a800ca69c2fcbcb4cb3b98117/">List supported protocols for Service (#12669)</a> (<a href="https://github.com/kubernetes/website/commits/master/content/en/docs%5cconcepts%5cservices-networking%5cservice.md">Page History</a>)
  </div>
  
</div>

  <div class="post-comment">
    
    


<div id="lv-container" data-id="city" data-uid="MTAyMC80MzQxMi8xOTk1Mw==">
  <script type="text/javascript">
    (function(d, s) {
      var j, e = d.getElementsByTagName(s)[0];

      if (typeof LivereTower === 'function') { return; }

      j = d.createElement(s);
      j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
      j.async = true;

      e.parentNode.insertBefore(j, e);
    })(document, 'script');
  </script>
  <noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
</div>



  </div>
  
  <div class="container" role="main" itemscope itemtype="http://schema.org/Article">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
        
        
<div>
  <h5 id="tags">Tags: 
  </h5>
</div>
        
        <article role="main" class="blog-post" itemprop="articleBody" id="content">
          ...
          





          
          <div class="social-share" data-initialized="true" data-wechat-qrcode-title="不扫别后悔">
  <center>
    <font style="font-size:18px;color:darkcyan;">分享到：</font>
    <a href="#" class="social-share-icon icon-weibo"></a>
    <a href="#" class="social-share-icon icon-wechat"></a>
    <a href="#" class="social-share-icon icon-twitter"></a>
    <a href="#" class="social-share-icon icon-linkedin"></a>
    <a href="#" class="social-share-icon icon-facebook"></a>
    <a href="#" class="social-share-icon icon-qq"></a>
    <a href="#" class="social-share-icon icon-qzone"></a>
  </center>
</div>


<script src="https://hugo-picture.oss-cn-beijing.aliyuncs.com/social-share.min.js"></script>
          
        </article>
      </div>
    </div>
  </div>
</section>

<footer>
    <main class="light-text">
        <nav>
            
            
            
            <a href="/docs/home/">Home</a>
            
            <a href="/blog/">Blog</a>
            
            <a href="/partners/">Partners</a>
            
            <a href="/community/">Community</a>
            
            <a href="/case-studies/">Case Studies</a>
            
        </nav>
        <div class="social">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
            <div>
                
                <a href="https://git.k8s.io/community/contributors/guide" class="button">Contribute</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2019 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a></a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2019 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
        <div id="miceType" class="center">
            ICP license: 京ICP备17074266号-3
        </div>
    </main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<script>

(function () {
    window.addEventListener('DOMContentLoaded', init)

        
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>



<script language="application/javascript">
  
  (function addHeadingLinks(){
    var article = document.getElementById('docsContent');
    var headings = article.querySelectorAll('h1, h2, h3, h4, h5, h6');
    headings.forEach(function(heading){
      if(heading.id){
        var a = document.createElement('a');
        a.innerHTML = heading.innerHTML;
        a.href = '#'+heading.id;
        a.classList.add('inpage_heading');
        heading.innerHTML = '';
        heading.appendChild(a);
      }
    });
  })();
</script>
</body>
</html>