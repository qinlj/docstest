<!DOCTYPE html>
<html id="docs" lang="en" class="">
<head>
  

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-36037335-10');
</script>
<meta charset="utf-8">
<title>Pod 安全策略 - SuperMap iDesktop .NET</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
<link rel="stylesheet" href="/css/base_fonts.css">
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="/css/jquery-ui.min.css">
<link rel="stylesheet" href="/css/sweetalert.min.css">
<link rel="stylesheet" href="/css/callouts.css">
<link rel="stylesheet" href="/css/custom-jekyll/tags.css">
<link rel="stylesheet" href="https://qinlj.github.io/css/main.css" />
<link rel="stylesheet" href="https://qinlj.github.io/css/share.min.css" />



<meta name="description" content="PodSecurityPolicy 类型的对象能够控制，是否可以向 Pod 发送请求，该 Pod 能够影响被应用到 Pod 和容器的 SecurityContext。 查看 Pod 安全策略建议 获取更多信息。
   什么是 Pod 安全策略？  RunAsUser SELinux SupplementalGroups FSGroup 控制卷 主机网络 允许的主机路径  许可 创建 Pod 安全策略 获取 Pod 安全策略列表 修改 Pod 安全策略 删除 Pod 安全策略 启用 Pod 安全策略 使用 RBAC    什么是 Pod 安全策略？ Pod 安全策略 是集群级别的资源，它能够控制 Pod 运行的行为，以及它具有访问什么的能力。 PodSecurityPolicy 对象定义了一组条件，指示 Pod 必须按系统所能接受的顺序运行。 它们允许管理员控制如下方面：
   控制面 字段名称     已授权容器的运行 privileged   为容器添加默认的一组能力 defaultAddCapabilities   为容器去掉某些能力 requiredDropCapabilities   容器能够请求添加某些能力 allowedCapabilities   控制卷类型的使用 volumes   主机网络的使用 hostNetwork   主机端口的使用 hostPorts   主机 PID namespace 的使用 hostPID   主机 IPC namespace 的使用 hostIPC   主机路径的使用 allowedHostPaths   容器的 SELinux 上下文 seLinux   用户 ID runAsUser   配置允许的补充组 supplementalGroups   分配拥有 Pod 数据卷的 FSGroup fsGroup   必须使用一个只读的 root 文件系统 readOnlyRootFilesystem    Pod 安全策略 由设置和策略组成，它们能够控制 Pod 访问的安全特征。这些设置分为如下三类：">
<meta property="og:description" content="PodSecurityPolicy 类型的对象能够控制，是否可以向 Pod 发送请求，该 Pod 能够影响被应用到 Pod 和容器的 SecurityContext。 查看 Pod 安全策略建议 获取更多信息。
   什么是 Pod 安全策略？  RunAsUser SELinux SupplementalGroups FSGroup 控制卷 主机网络 允许的主机路径  许可 创建 Pod 安全策略 获取 Pod 安全策略列表 修改 Pod 安全策略 删除 Pod 安全策略 启用 Pod 安全策略 使用 RBAC    什么是 Pod 安全策略？ Pod 安全策略 是集群级别的资源，它能够控制 Pod 运行的行为，以及它具有访问什么的能力。 PodSecurityPolicy 对象定义了一组条件，指示 Pod 必须按系统所能接受的顺序运行。 它们允许管理员控制如下方面：
   控制面 字段名称     已授权容器的运行 privileged   为容器添加默认的一组能力 defaultAddCapabilities   为容器去掉某些能力 requiredDropCapabilities   容器能够请求添加某些能力 allowedCapabilities   控制卷类型的使用 volumes   主机网络的使用 hostNetwork   主机端口的使用 hostPorts   主机 PID namespace 的使用 hostPID   主机 IPC namespace 的使用 hostIPC   主机路径的使用 allowedHostPaths   容器的 SELinux 上下文 seLinux   用户 ID runAsUser   配置允许的补充组 supplementalGroups   分配拥有 Pod 数据卷的 FSGroup fsGroup   必须使用一个只读的 root 文件系统 readOnlyRootFilesystem    Pod 安全策略 由设置和策略组成，它们能够控制 Pod 访问的安全特征。这些设置分为如下三类：">
<meta name="twitter:description" content="PodSecurityPolicy 类型的对象能够控制，是否可以向 Pod 发送请求，该 Pod 能够影响被应用到 Pod 和容器的 SecurityContext。 查看 Pod 安全策略建议 获取更多信息。
   什么是 Pod 安全策略？  RunAsUser SELinux SupplementalGroups FSGroup 控制卷 主机网络 允许的主机路径  许可 创建 Pod 安全策略 获取 Pod 安全策略列表 修改 Pod 安全策略 删除 Pod 安全策略 启用 Pod 安全策略 使用 RBAC    什么是 Pod 安全策略？ Pod 安全策略 是集群级别的资源，它能够控制 Pod 运行的行为，以及它具有访问什么的能力。 PodSecurityPolicy 对象定义了一组条件，指示 Pod 必须按系统所能接受的顺序运行。 它们允许管理员控制如下方面：
   控制面 字段名称     已授权容器的运行 privileged   为容器添加默认的一组能力 defaultAddCapabilities   为容器去掉某些能力 requiredDropCapabilities   容器能够请求添加某些能力 allowedCapabilities   控制卷类型的使用 volumes   主机网络的使用 hostNetwork   主机端口的使用 hostPorts   主机 PID namespace 的使用 hostPID   主机 IPC namespace 的使用 hostIPC   主机路径的使用 allowedHostPaths   容器的 SELinux 上下文 seLinux   用户 ID runAsUser   配置允许的补充组 supplementalGroups   分配拥有 Pod 数据卷的 FSGroup fsGroup   必须使用一个只读的 root 文件系统 readOnlyRootFilesystem    Pod 安全策略 由设置和策略组成，它们能够控制 Pod 访问的安全特征。这些设置分为如下三类：">
<meta property="og:url" content="https://qinlj.github.io/zh/docs/concepts/policy/pod-security-policy/">
<meta property="og:title" content="Pod 安全策略">
<meta name="twitter:title" content="Pod 安全策略">

<meta name="twitter:image:alt"   content="SuperMap iDesktop .NET">

<meta property="og:image" content="/images/kubernetes-horizontal-color.png">

<meta property="og:type" content="article">
<script src="/js/anchor-4.1.1.min.js"></script>
<script src="/js/jquery-3.2.1.min.js"></script>
<script src="/js/jquery-ui-1.12.1.min.js"></script>
<script src="/js/bootstrap-3.3.7.min.js"></script>
<script src="/js/sweetalert-1.1.3.min.js"></script>
<script src="/js/script.js"></script>
<script src="/js/custom-jekyll/tags.js"></script>


</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/zh/" class="logo"></a>
  <div class="left-buttons" data-auto-burger="primary">
    <ul class="global-nav">
      <li>
        <a href="#">
          v1.13 <span class="ui-icon ui-icon-carat-1-s"></span>
        </a>
        <ul>
          
          <li><a href="https://kubernetes.io">v1.13</a></li>
          
          <li><a href="https://supermaphehh.github.io/zh/">iDesktop .NET</a></li>
          
          <li><a href="https://v1-12.docs.kubernetes.io">v1.12</a></li>
          
          <li><a href="https://v1-11.docs.kubernetes.io">v1.11</a></li>
          
          <li><a href="https://v1-10.docs.kubernetes.io">v1.10</a></li>
          
          <li><a href="https://v1-9.docs.kubernetes.io">v1.9</a></li>
          
        </ul>
      </li>
    </ul>
  </div>
    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            
            
            <li><a href="/zh/docs/" class="active">GIS 百科</a></li>
            
            <li><a href="/zh/blog/">技术专题</a></li>
            
            
            
            
            
            <li><a href="/zh/case-studies/">三维技术专题</a></li>
            
            
            
             <li>
                <a href="#">
                    中文 Chinese <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="/docs/concepts/policy/pod-security-policy/">English</a></li>
                
                </ul>
            </li>

            <li>
                <a href="#">
                    v1.13 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="https://kubernetes.io">v1.13</a></li>
                
                    <li><a href="https://supermaphehh.github.io/zh/">iDesktop .NET</a></li>
                
                    <li><a href="https://v1-12.docs.kubernetes.io">v1.12</a></li>
                
                    <li><a href="https://v1-11.docs.kubernetes.io">v1.11</a></li>
                
                    <li><a href="https://v1-10.docs.kubernetes.io">v1.10</a></li>
                
                    <li><a href="https://v1-9.docs.kubernetes.io">v1.9</a></li>
                
                </ul>
            </li>
        </ul>

        <form id="searchBox" action="/search/">
          <input type="text" id="search" name="q" placeholder="搜索" aria-label="Search">
        </form>

    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
         
           <div class="nav-box">
            <h3><a href="/zh/docs/home/">文档</a></h3>
           <p>通过演练，示例和参考文档了解如何使用 Kubernetes。你甚至可以<a href="/editdocs/" data-auto-burger-exclude>帮助贡献文档</a>！</p>

        </div>
         
           <div class="nav-box">
            <h3><a href="/zh/blog/">技术专题</a></h3>
           <p>阅读关于 kubernetes 和容器规范的最新信息,以及获取最新的技术。</p>

        </div>
         
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">想要修改 Kubernetes 的核心源代码</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>在 GitHub 上查看</a>
        </div>

        <div class="right">
            <h5 class="github-invite">了解社区</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack Slack</span></a>
                <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>



<section id="hero" class="light-text no-sub">
  













<h1>概念</h1>
<h5></h5>


<div id="vendorStrip" class="light-text">
	<ul>
		
		
		<li><a href="/zh/docs/home/">主页</a></li>
		
		
		<li><a href="/zh/docs/surfaceanalyst/">表面分析</a></li>
		
		
		<li><a href="/zh/docs/datamanage/">数据管理</a></li>
		
		
		<li><a href="/zh/docs/dataconversion/">数据转换</a></li>
		
		
		<li><a href="/zh/docs/concepts/" class="YAH">概念</a></li>
		
	</ul>
	<form id="searchBox" action="/docs/search/">
		<input type="text" id="search" name="q" placeholder="搜索" aria-label="Search">
  </form>
</div>

</section>



<section id="encyclopedia">
  
<div id="docsToc">
     <div class="pi-accordion">
    	
        
        
        
        
        
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
                          
                          
                 
             
         
             
         
             
         
             
         
             
         
         
        
        <a class="item" data-title="概念" href="/zh/docs/concepts/"></a>

	
	
			
			
			
			
			
		
	
	
	
		
			
<div class="item" data-title="Overview">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="What is Kubernetes? <small>(EN)</small>" href="/docs/concepts/overview/what-is-kubernetes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Kubernetes Components <small>(EN)</small>" href="/docs/concepts/overview/components/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="The Kubernetes API <small>(EN)</small>" href="/docs/concepts/overview/kubernetes-api/"></a>

		
	
		
			
<div class="item" data-title="Working with Kubernetes Objects">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Understanding Kubernetes Objects <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/kubernetes-objects/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Names <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/names/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Namespaces <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/namespaces/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Labels and Selectors <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/labels/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Annotations <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/annotations/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Field Selectors <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/field-selectors/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Recommended Labels <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/common-labels/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Object Management Using kubectl">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Kubernetes Object Management <small>(EN)</small>" href="/docs/concepts/overview/object-management-kubectl/overview/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Managing Kubernetes Objects Using Imperative Commands <small>(EN)</small>" href="/docs/concepts/overview/object-management-kubectl/imperative-command/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Imperative Management of Kubernetes Objects Using Configuration Files <small>(EN)</small>" href="/docs/concepts/overview/object-management-kubectl/imperative-config/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Declarative Management of Kubernetes Objects Using Configuration Files <small>(EN)</small>" href="/docs/concepts/overview/object-management-kubectl/declarative-config/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Kubernetes Architecture">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Nodes <small>(EN)</small>" href="/docs/concepts/architecture/nodes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Master-Node communication <small>(EN)</small>" href="/docs/concepts/architecture/master-node-communication/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Concepts Underlying the Cloud Controller Manager <small>(EN)</small>" href="/docs/concepts/architecture/cloud-controller/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Containers">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Images <small>(EN)</small>" href="/docs/concepts/containers/images/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Container Environment Variables <small>(EN)</small>" href="/docs/concepts/containers/container-environment-variables/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Runtime Class <small>(EN)</small>" href="/docs/concepts/containers/runtime-class/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Container Lifecycle Hooks <small>(EN)</small>" href="/docs/concepts/containers/container-lifecycle-hooks/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" data-title="Taint 和 Toleration" href="/zh/docs/concepts/configuration/taint-and-toleration/"></a>

		
	
		
			
<div class="item" data-title="工作负载">
	<div class="container">
		
		
		
		<a class="item" data-title="工作负载" href="/zh/docs/concepts/workloads/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			
<div class="item" data-title="Pods">
	<div class="container">
		
		
		
		<a class="item" data-title="Pods" href="/zh/docs/concepts/workloads/pods/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Pod Overview <small>(EN)</small>" href="/docs/concepts/workloads/pods/pod-overview/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Pods <small>(EN)</small>" href="/docs/concepts/workloads/pods/pod/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Disruptions <small>(EN)</small>" href="/docs/concepts/workloads/pods/disruptions/"></a>

		
	
		
			

<a class="item" data-title="Init 容器" href="/zh/docs/concepts/workloads/pods/init-containers/"></a>

		
	
		
			

<a class="item" data-title="Pod Preset" href="/zh/docs/concepts/workloads/pods/podpreset/"></a>

		
	
		
			

<a class="item" data-title="Pod 的生命周期" href="/zh/docs/concepts/workloads/pods/pod-lifecycle/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Controllers">
	<div class="container">
		
		
		
		<a class="item" data-title="Controllers" href="/zh/docs/concepts/workloads/controllers/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="ReplicaSet <small>(EN)</small>" href="/docs/concepts/workloads/controllers/replicaset/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="ReplicationController <small>(EN)</small>" href="/docs/concepts/workloads/controllers/replicationcontroller/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="StatefulSets <small>(EN)</small>" href="/docs/concepts/workloads/controllers/statefulset/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="TTL Controller for Finished Resources <small>(EN)</small>" href="/docs/concepts/workloads/controllers/ttlafterfinished/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Jobs - Run to Completion <small>(EN)</small>" href="/docs/concepts/workloads/controllers/jobs-run-to-completion/"></a>

		
	
		
			

<a class="item" data-title="Cron Job" href="/zh/docs/concepts/workloads/controllers/cron-jobs/"></a>

		
	
		
			

<a class="item" data-title="DaemonSet" href="/zh/docs/concepts/workloads/controllers/daemonset/"></a>

		
	
		
			

<a class="item" data-title="Deployments" href="/zh/docs/concepts/workloads/controllers/deployment/"></a>

		
	
		
			

<a class="item" data-title="垃圾收集" href="/zh/docs/concepts/workloads/controllers/garbage-collection/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Services, Load Balancing, and Networking">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Services <small>(EN)</small>" href="/docs/concepts/services-networking/service/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="DNS for Services and Pods <small>(EN)</small>" href="/docs/concepts/services-networking/dns-pod-service/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Connecting Applications with Services <small>(EN)</small>" href="/docs/concepts/services-networking/connect-applications-service/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Ingress <small>(EN)</small>" href="/docs/concepts/services-networking/ingress/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Ingress Controllers <small>(EN)</small>" href="/docs/concepts/services-networking/ingress-controllers/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Network Policies <small>(EN)</small>" href="/docs/concepts/services-networking/network-policies/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Adding entries to Pod /etc/hosts with HostAliases <small>(EN)</small>" href="/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="存储">
	<div class="container">
		
		
		
		<a class="item" data-title="存储" href="/zh/docs/concepts/storage/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Volumes <small>(EN)</small>" href="/docs/concepts/storage/volumes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Persistent Volumes <small>(EN)</small>" href="/docs/concepts/storage/persistent-volumes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Volume Snapshots <small>(EN)</small>" href="/docs/concepts/storage/volume-snapshots/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Storage Classes <small>(EN)</small>" href="/docs/concepts/storage/storage-classes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Volume Snapshot Classes <small>(EN)</small>" href="/docs/concepts/storage/volume-snapshot-classes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Dynamic Volume Provisioning <small>(EN)</small>" href="/docs/concepts/storage/dynamic-provisioning/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Node-specific Volume Limits <small>(EN)</small>" href="/docs/concepts/storage/storage-limits/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Configuration">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Configuration Best Practices <small>(EN)</small>" href="/docs/concepts/configuration/overview/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Managing Compute Resources for Containers <small>(EN)</small>" href="/docs/concepts/configuration/manage-compute-resources-container/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Assigning Pods to Nodes <small>(EN)</small>" href="/docs/concepts/configuration/assign-pod-node/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Taints and Tolerations <small>(EN)</small>" href="/docs/concepts/configuration/taint-and-toleration/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Secrets <small>(EN)</small>" href="/docs/concepts/configuration/secret/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Organizing Cluster Access Using kubeconfig Files <small>(EN)</small>" href="/docs/concepts/configuration/organize-cluster-access-kubeconfig/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Pod Priority and Preemption <small>(EN)</small>" href="/docs/concepts/configuration/pod-priority-preemption/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Scheduler Performance Tuning <small>(EN)</small>" href="/docs/concepts/configuration/scheduler-perf-tuning/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Policies">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Resource Quotas <small>(EN)</small>" href="/docs/concepts/policy/resource-quotas/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Pod Security Policies <small>(EN)</small>" href="/docs/concepts/policy/pod-security-policy/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Cluster Administration">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Cluster Administration Overview <small>(EN)</small>" href="/docs/concepts/cluster-administration/cluster-administration-overview/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Certificates <small>(EN)</small>" href="/docs/concepts/cluster-administration/certificates/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Cloud Providers <small>(EN)</small>" href="/docs/concepts/cluster-administration/cloud-providers/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Managing Resources <small>(EN)</small>" href="/docs/concepts/cluster-administration/manage-deployment/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Cluster Networking <small>(EN)</small>" href="/docs/concepts/cluster-administration/networking/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Logging Architecture <small>(EN)</small>" href="/docs/concepts/cluster-administration/logging/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Configuring kubelet Garbage Collection <small>(EN)</small>" href="/docs/concepts/cluster-administration/kubelet-garbage-collection/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Federation <small>(EN)</small>" href="/docs/concepts/cluster-administration/federation/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Proxies in Kubernetes <small>(EN)</small>" href="/docs/concepts/cluster-administration/proxies/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Controller manager metrics <small>(EN)</small>" href="/docs/concepts/cluster-administration/controller-metrics/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Installing Addons <small>(EN)</small>" href="/docs/concepts/cluster-administration/addons/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Extending Kubernetes">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Extending your Kubernetes Cluster <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/extend-cluster/"></a>

		
	
		
			
<div class="item" data-title="Extending the Kubernetes API">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Extending the Kubernetes API with the aggregation layer <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/api-extension/apiserver-aggregation/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Custom Resources <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/api-extension/custom-resources/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Compute, Storage, and Networking Extensions">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Network Plugins <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Device Plugins <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/compute-storage-net/device-plugins/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" target="_blank" data-title="Service Catalog <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/service-catalog/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Poseidon-Firmament - An alternate scheduler <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/poseidon-firmament-alternate-scheduler/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" data-title="" href="/zh/docs/concepts/architecture/cloud-controller/"></a>

		
	
		
			

<a class="item" data-title="" href="/zh/docs/concepts/overview/kubernetes-api/"></a>

		
	
		
			

<a class="item" data-title="DNS Pod 与 Service" href="/zh/docs/concepts/services-networking/dns-pod-service/"></a>

		
	
		
			

<a class="item" data-title="Kubernetes 中的代理" href="/zh/docs/concepts/cluster-administration/proxies/"></a>

		
	
		
			

<a class="item" data-title="Kubernetes 组件" href="/zh/docs/concepts/overview/components/"></a>

		
	
		
			

<a class="item" data-title="Kubernetes集群中使用Sysctls" href="/zh/docs/concepts/cluster-administration/sysctl-cluster/"></a>

		
	
		
			

<a class="item" data-title="Managing Compute Resources for Containers" href="/zh/docs/concepts/configuration/manage-compute-resources-container/"></a>

		
	
		
			

<a class="item" data-title="Master 节点通信" href="/zh/docs/concepts/architecture/master-node-communication/"></a>

		
	
		
			

<a class="item" data-title="Nodes" href="/zh/docs/concepts/architecture/nodes/"></a>

		
	
		
			

<a class="item" data-title="Pod 安全策略" href="/zh/docs/concepts/policy/pod-security-policy/"></a>

		
	
		
			

<a class="item" data-title="Secret" href="/zh/docs/concepts/configuration/secret/"></a>

		
	
		
			

<a class="item" data-title="Service" href="/zh/docs/concepts/services-networking/service/"></a>

		
	
		
			

<a class="item" data-title="云供应商" href="/zh/docs/concepts/cluster-administration/cloud-providers/"></a>

		
	
		
			

<a class="item" data-title="使用 HostAliases 向 Pod /etc/hosts 文件添加条目" href="/zh/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/"></a>

		
	
		
			

<a class="item" data-title="安装扩展（Addons）" href="/zh/docs/concepts/cluster-administration/addons/"></a>

		
	
		
			

<a class="item" data-title="容器环境变量" href="/zh/docs/concepts/containers/container-environment-variables/"></a>

		
	
		
			

<a class="item" data-title="应用连接到 Service" href="/zh/docs/concepts/services-networking/connect-applications-service/"></a>

		
	
		
			

<a class="item" data-title="概念模板示例" href="/zh/docs/concepts/example-concept-template/"></a>

		
	
		
			

<a class="item" data-title="理解 Kubernetes 对象" href="/zh/docs/concepts/overview/working-with-objects/kubernetes-objects/"></a>

		
	
		
			

<a class="item" data-title="网络策略" href="/zh/docs/concepts/services-networking/network-policies/"></a>

		
	
		
			

<a class="item" data-title="联邦" href="/zh/docs/concepts/cluster-administration/federation/"></a>

		
	
		
			

<a class="item" data-title="认识 Kubernetes?" href="/zh/docs/concepts/overview/what-is-kubernetes/"></a>

		
	
		
			

<a class="item" data-title="设备插件" href="/zh/docs/concepts/cluster-administration/device-plugins/"></a>

		
	
		
			

<a class="item" data-title="证书" href="/zh/docs/concepts/cluster-administration/certificates/"></a>

		
	
		
			

<a class="item" data-title="资源配额" href="/zh/docs/concepts/policy/resource-quotas/"></a>

		
	
		
			

<a class="item" data-title="镜像" href="/zh/docs/concepts/containers/images/"></a>

		
	
		
			

<a class="item" data-title="集群管理概述" href="/zh/docs/concepts/cluster-administration/cluster-administration-overview/"></a>

		
	





     </div> 
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 


  <div id="docsContent">
  

<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/zh/docs%5cconcepts%5cpolicy%5cpod-security-policy.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>

<h1>Pod 安全策略</h1>





<p><code>PodSecurityPolicy</code> 类型的对象能够控制，是否可以向 Pod 发送请求，该 Pod 能够影响被应用到 Pod 和容器的 <code>SecurityContext</code>。
查看 <a href="https://git.k8s.io/community/contributors/design-proposals/security-context-constraints.md" target="_blank">Pod 安全策略建议</a> 获取更多信息。</p>

<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#什么是-pod-安全策略">什么是 Pod 安全策略？</a>
<ul>
<li><a href="#runasuser">RunAsUser</a></li>
<li><a href="#selinux">SELinux</a></li>
<li><a href="#supplementalgroups">SupplementalGroups</a></li>
<li><a href="#fsgroup">FSGroup</a></li>
<li><a href="#控制卷">控制卷</a></li>
<li><a href="#主机网络">主机网络</a></li>
<li><a href="#允许的主机路径">允许的主机路径</a></li>
</ul></li>
<li><a href="#许可">许可</a></li>
<li><a href="#创建-pod-安全策略">创建 Pod 安全策略</a></li>
<li><a href="#获取-pod-安全策略列表">获取 Pod 安全策略列表</a></li>
<li><a href="#修改-pod-安全策略">修改 Pod 安全策略</a></li>
<li><a href="#删除-pod-安全策略">删除 Pod 安全策略</a></li>
<li><a href="#启用-pod-安全策略">启用 Pod 安全策略</a></li>
<li><a href="#使用-rbac">使用 RBAC</a></li>
</ul></li>
</ul>
</nav>

<h2 id="什么是-pod-安全策略">什么是 Pod 安全策略？</h2>

<p><em>Pod 安全策略</em> 是集群级别的资源，它能够控制 Pod 运行的行为，以及它具有访问什么的能力。
<code>PodSecurityPolicy</code> 对象定义了一组条件，指示 Pod 必须按系统所能接受的顺序运行。
它们允许管理员控制如下方面：</p>

<table>
<thead>
<tr>
<th>控制面</th>
<th>字段名称</th>
</tr>
</thead>

<tbody>
<tr>
<td>已授权容器的运行</td>
<td><code>privileged</code></td>
</tr>

<tr>
<td>为容器添加默认的一组能力</td>
<td><code>defaultAddCapabilities</code></td>
</tr>

<tr>
<td>为容器去掉某些能力</td>
<td><code>requiredDropCapabilities</code></td>
</tr>

<tr>
<td>容器能够请求添加某些能力</td>
<td><code>allowedCapabilities</code></td>
</tr>

<tr>
<td>控制卷类型的使用</td>
<td><a href="#controlling-volumes"><code>volumes</code></a></td>
</tr>

<tr>
<td>主机网络的使用</td>
<td><a href="#host-network"><code>hostNetwork</code></a></td>
</tr>

<tr>
<td>主机端口的使用</td>
<td><code>hostPorts</code></td>
</tr>

<tr>
<td>主机 PID namespace 的使用</td>
<td><code>hostPID</code></td>
</tr>

<tr>
<td>主机 IPC namespace 的使用</td>
<td><code>hostIPC</code></td>
</tr>

<tr>
<td>主机路径的使用</td>
<td><a href="#allowed-host-paths"><code>allowedHostPaths</code></a></td>
</tr>

<tr>
<td>容器的 SELinux 上下文</td>
<td><a href="#selinux"><code>seLinux</code></a></td>
</tr>

<tr>
<td>用户 ID</td>
<td><a href="#runasuser"><code>runAsUser</code></a></td>
</tr>

<tr>
<td>配置允许的补充组</td>
<td><a href="#supplementalgroups"><code>supplementalGroups</code></a></td>
</tr>

<tr>
<td>分配拥有 Pod 数据卷的 FSGroup</td>
<td><a href="#fsgroup"><code>fsGroup</code></a></td>
</tr>

<tr>
<td>必须使用一个只读的 root 文件系统</td>
<td><code>readOnlyRootFilesystem</code></td>
</tr>
</tbody>
</table>

<p><em>Pod 安全策略</em> 由设置和策略组成，它们能够控制 Pod 访问的安全特征。这些设置分为如下三类：</p>

<ul>
<li>*基于布尔值控制*：这种类型的字段默认为最严格限制的值。</li>
<li>*基于被允许的值集合控制*：这种类型的字段会与这组值进行对比，以确认值被允许。</li>
<li>*基于策略控制*：设置项通过一种策略提供的机制来生成该值，这种机制能够确保指定的值落在被允许的这组值中。</li>
</ul>

<h3 id="runasuser">RunAsUser</h3>

<ul>
<li><em>MustRunAs</em> - 必须配置一个 <code>range</code>。使用该范围内的第一个值作为默认值。验证是否不在配置的该范围内。</li>
<li><em>MustRunAsNonRoot</em> - 要求提交的 Pod 具有非零 <code>runAsUser</code> 值，或在镜像中定义了 <code>USER</code> 环境变量。不提供默认值。</li>
<li><em>RunAsAny</em> - 没有提供默认值。允许指定任何 <code>runAsUser</code> 。</li>
</ul>

<h3 id="selinux">SELinux</h3>

<ul>
<li><em>MustRunAs</em> - 如果没有使用预分配的值，必须配置 <code>seLinuxOptions</code>。默认使用 <code>seLinuxOptions</code>。验证 <code>seLinuxOptions</code>。</li>
<li><em>RunAsAny</em> - 没有提供默认值。允许任意指定的 <code>seLinuxOptions</code> ID。</li>
</ul>

<h3 id="supplementalgroups">SupplementalGroups</h3>

<ul>
<li><em>MustRunAs</em> - 至少需要指定一个范围。默认使用第一个范围的最小值。验证所有范围的值。</li>
<li><em>RunAsAny</em> - 没有提供默认值。允许任意指定的 <code>supplementalGroups</code> ID。</li>
</ul>

<h3 id="fsgroup">FSGroup</h3>

<ul>
<li><em>MustRunAs</em> - 至少需要指定一个范围。默认使用第一个范围的最小值。验证在第一个范围内的第一个 ID。</li>
<li><em>RunAsAny</em> - 没有提供默认值。允许任意指定的 <code>fsGroup</code> ID。</li>
</ul>

<h3 id="控制卷">控制卷</h3>

<p>通过设置 PSP 卷字段，能够控制具体卷类型的使用。当创建一个卷的时候，与该字段相关的已定义卷可以允许设置如下值：</p>

<ol>
<li>azureFile</li>
<li>azureDisk</li>
<li>flocker</li>
<li>flexVolume</li>
<li>hostPath</li>
<li>emptyDir</li>
<li>gcePersistentDisk</li>
<li>awsElasticBlockStore</li>
<li>gitRepo</li>
<li>secret</li>
<li>nfs</li>
<li>iscsi</li>
<li>glusterfs</li>
<li>persistentVolumeClaim</li>
<li>rbd</li>
<li>cinder</li>
<li>cephFS</li>
<li>downwardAPI</li>
<li>fc</li>
<li>configMap</li>
<li>vsphereVolume</li>
<li>quobyte</li>
<li>projected</li>
<li>portworxVolume</li>
<li>scaleIO</li>
<li>storageos</li>
<li>* (allow all volumes)</li>
</ol>

<p>对新的 PSP，推荐允许的卷的最小集合包括：configMap、downwardAPI、emptyDir、persistentVolumeClaim、secret 和 projected。</p>

<h3 id="主机网络">主机网络</h3>

<ul>
<li>*HostPorts*， 默认为 <code>empty</code>。<code>HostPortRange</code> 列表通过 <code>min</code>(包含) and <code>max</code>(包含) 来定义，指定了被允许的主机端口。</li>
</ul>

<h3 id="允许的主机路径">允许的主机路径</h3>

<ul>
<li><em>AllowedHostPaths</em> 是一个被允许的主机路径前缀的白名单。空值表示所有的主机路径都可以使用。</li>
</ul>

<h2 id="许可">许可</h2>

<p>包含 <code>PodSecurityPolicy</code> 的 _许可控制_，允许控制集群资源的创建和修改，基于这些资源在集群范围内被许可的能力。</p>

<p>许可使用如下的方式为 Pod 创建最终的安全上下文：
1. 检索所有可用的 PSP。
1. 生成在请求中没有指定的安全上下文设置的字段值。
1. 基于可用的策略，验证最终的设置。</p>

<p>如果某个策略能够匹配上，该 Pod 就被接受。如果请求与 PSP 不匹配，则 Pod 被拒绝。</p>

<p>Pod 必须基于 PSP 验证每个字段。</p>

<h2 id="创建-pod-安全策略">创建 Pod 安全策略</h2>

<p>下面是一个 Pod 安全策略的例子，所有字段的设置都被允许：</p>



 













<table class="includecode" id="psp-yaml">
    <thead>
        <tr>
            <th>
                <a href="https://github.com/kubernetes/website/blob/master/content/zh/docs/concepts/policy/psp.yaml" download="psp.yaml">
                    <code>psp.yaml docs/concepts/policy</code>
                </a>
                <img src="/images/copycode.svg" style="max-height:24px" onclick="copyCode('psp-yaml')" title="Copy psp.yaml to clipboard">
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>extensions/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>PodSecurityPolicy<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>permissive<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>seLinux:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>rule:<span style="color:#bbb"> </span>RunAsAny<span style="color:#bbb">
</span><span style="color:#bbb">  </span>supplementalGroups:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>rule:<span style="color:#bbb"> </span>RunAsAny<span style="color:#bbb">
</span><span style="color:#bbb">  </span>runAsUser:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>rule:<span style="color:#bbb"> </span>RunAsAny<span style="color:#bbb">
</span><span style="color:#bbb">  </span>fsGroup:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>rule:<span style="color:#bbb"> </span>RunAsAny<span style="color:#bbb">
</span><span style="color:#bbb">  </span>hostPorts:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>min:<span style="color:#bbb"> </span><span style="color:#666">8000</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>max:<span style="color:#bbb"> </span><span style="color:#666">8080</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span><span style="color:#b44">&#39;*&#39;</span><span style="color:#bbb">
</span></code></pre></div>  </td>
        </tr>
    </tbody>
</table>



<p>下载示例文件可以创建该策略，然后执行如下命令：</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl create -f ./psp.yaml
podsecuritypolicy <span style="color:#b44">&#34;permissive&#34;</span> created</code></pre></div>
<h2 id="获取-pod-安全策略列表">获取 Pod 安全策略列表</h2>

<p>获取已存在策略列表，使用 <code>kubectl get</code>：</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get psp
NAME        PRIV   CAPS  SELINUX   RUNASUSER         FSGROUP   SUPGROUP  READONLYROOTFS  VOLUMES
permissive  <span style="color:#a2f">false</span>  <span style="color:#666">[]</span>    RunAsAny  RunAsAny          RunAsAny  RunAsAny  <span style="color:#a2f">false</span>           <span style="color:#666">[</span>*<span style="color:#666">]</span>
privileged  <span style="color:#a2f">true</span>   <span style="color:#666">[]</span>    RunAsAny  RunAsAny          RunAsAny  RunAsAny  <span style="color:#a2f">false</span>           <span style="color:#666">[</span>*<span style="color:#666">]</span>
restricted  <span style="color:#a2f">false</span>  <span style="color:#666">[]</span>    RunAsAny  MustRunAsNonRoot  RunAsAny  RunAsAny  <span style="color:#a2f">false</span>           <span style="color:#666">[</span>emptyDir secret downwardAPI configMap persistentVolumeClaim projected<span style="color:#666">]</span></code></pre></div>
<h2 id="修改-pod-安全策略">修改 Pod 安全策略</h2>

<p>通过交互方式修改策略，使用 <code>kubectl edit</code>：</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl edit psp permissive</code></pre></div>
<p>该命令将打开一个默认文本编辑器，在这里能够修改策略。</p>

<h2 id="删除-pod-安全策略">删除 Pod 安全策略</h2>

<p>一旦不再需要一个策略，很容易通过 <code>kubectl</code> 删除它：</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl delete psp permissive
podsecuritypolicy <span style="color:#b44">&#34;permissive&#34;</span> deleted</code></pre></div>
<h2 id="启用-pod-安全策略">启用 Pod 安全策略</h2>

<p>为了能够在集群中使用 Pod 安全策略，必须确保满足如下条件：</p>

<ol>
<li>已经启用 API 类型 <code>extensions/v1beta1/podsecuritypolicy</code>（仅对 1.6 之前的版本）</li>
<li>已经启用许可控制器 <code>PodSecurityPolicy</code></li>
<li>已经定义了自己的策略</li>
</ol>

<h2 id="使用-rbac">使用 RBAC</h2>

<p>在 Kubernetes 1.5 或更新版本，可以使用 PodSecurityPolicy 来控制，对基于用户角色和组的已授权容器的访问。访问不同的 PodSecurityPolicy 对象，可以基于认证来控制。基于 Deployment、ReplicaSet 等创建的 Pod，限制访问 PodSecurityPolicy 对象，<a href="/docs/admin/kube-controller-manager/">Controller Manager</a> 必须基于安全 API 端口运行，并且不能够具有超级用户权限。</p>

<p>PodSecurityPolicy 认证使用所有可用的策略，包括创建 Pod 的用户，Pod 上指定的服务账户（Service Account）。当 Pod 基于 Deployment、ReplicaSet 创建时，它是创建 Pod 的 Controller Manager，所以如果基于非安全 API 端口运行，允许所有的 PodSecurityPolicy 对象，并且不能够有效地实现细分权限。用户访问给定的 PSP 策略有效，仅当是直接部署 Pod 的情况。更多详情，查看 <a href="https://git.k8s.io/kubernetes/examples/podsecuritypolicy/rbac/README.md" target="_blank">PodSecurityPolicy RBAC 示例</a>，当直接部署 Pod 时，应用 PodSecurityPolicy 控制基于角色和组的已授权容器的访问 。</p>



<nav class="pagination" style="font-size: 16px; font-weight: bold"><a class="nav nav-prev" href="/zh/docs/concepts/architecture/nodes/" title="Nodes"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Nodes</a>
<a class="nav nav-next" style="float:right"  href="/zh/docs/concepts/configuration/secret/" title="Secret">Next - Secret <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav>


  
  <h2>反馈</h2>
  <p class="feedback--prompt">此页是否对您有帮助？ </p>
  <button class="button feedback--yes">是</button>
  <button class="button feedback--no">否</button>
  <p class="feedback--response feedback--response__hidden">
    Thanks for the feedback. If you have a specific, answerable question about how to use Kubernetes,
    ask it on <a target="_blank" rel="noopener"
    href="https://stackoverflow.com/questions/tagged/kubernetes">Stack Overflow</a>. Open
    an issue in the GitHub repo if you want to <a class="feedback--link" target="_blank" rel="noopener"
    href="https://github.com/kubernetes/website/issues/new?title=Issue%20with%20k8s.io">report a problem</a> or
    <a class="feedback--link" target="_blank" rel="noopener"
    href="https://github.com/kubernetes/website/issues/new?title=Improvement%20for%20k8s.io">suggest an improvement</a>.
  </p>
  <script>
    const yes = document.querySelector('.feedback--yes');
    const no = document.querySelector('.feedback--no');
    document.querySelectorAll('.feedback--link').forEach(link => {
      link.href = link.href + window.location.pathname;
    });
    const sendFeedback = (value) => {
      if (!gtag) { console.log('!gtag'); }
      gtag('event', 'click', {
        'event_category': 'Helpful',
        'event_label': window.location.pathname,
        value
      });
    };
    const disableButtons = () => {
      yes.disabled = true;
      yes.classList.add('feedback--button__disabled');
      no.disabled = true;
      no.classList.add('feedback--button__disabled');
    };
    yes.addEventListener('click', () => {
      sendFeedback(1);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
    no.addEventListener('click', () => {
      sendFeedback(0);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
  </script>


  <div id="pre-footer"> 
  <hr />

  <div class="issue-button-container">
    <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs%5cconcepts%5cpolicy%5cpod-security-policy.md?pixel" alt="Analytics" /></a></p>
    
    
    <script type="text/javascript">
    PDRTJS_settings_8345992 = {
    "id" : "8345992",
    "unique_id" : "\/zh\/docs\/concepts\/policy\/pod-security-policy\/",
    "title" : "Pod 安全策略",
    "permalink" : "https:\/\/qinlj.github.io\/zh\/docs\/concepts\/policy\/pod-security-policy\/"
    };
    (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
    </script>
    <a href="" onclick="window.open('https://github.com/kubernetes/website/issues/new?title=Issue%20with%20' +
    'k8s.io'+window.location.pathname)" class="button issue">创建 GitHub issue</a>
    
    
    
    <a href="https://github.com/kubernetes/website/edit/master/content/zh/docs%5cconcepts%5cpolicy%5cpod-security-policy.md" class="button issue">修改本页面</a>
    
  </div>
  

  <div id="lastedit" class="lastedit issue-button-container">
    页面最后一次修改于 October 27, 2018 at 3:14 PM PST by
    <a href="https://github.com/kubernetes/website/commit/509a4e15e9a17c20a7de25c4eeee2673b6004951/">Update pod-security-policy.md (#10740)</a> (<a href="https://github.com/kubernetes/website/commits/master/content/en/docs%5cconcepts%5cpolicy%5cpod-security-policy.md">页面历史</a>)
  </div>
  
</div>

  <div class="post-comment">
    
    


<div id="lv-container" data-id="city" data-uid="MTAyMC80MzQxMi8xOTk1Mw==">
  <script type="text/javascript">
    (function(d, s) {
      var j, e = d.getElementsByTagName(s)[0];

      if (typeof LivereTower === 'function') { return; }

      j = d.createElement(s);
      j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
      j.async = true;

      e.parentNode.insertBefore(j, e);
    })(document, 'script');
  </script>
  <noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
</div>



  </div>
  
  <div class="container" role="main" itemscope itemtype="http://schema.org/Article">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
        
        
<div>
  <h5 id="tags">Tags: 
  </h5>
</div>
        
        <article role="main" class="blog-post" itemprop="articleBody" id="content">
          ...
          

<p><code>PodSecurityPolicy</code> 类型的对象能够控制，是否可以向 Pod 发送请求，该 Pod 能够影响被应用到 Pod 和容器的 <code>SecurityContext</code>。
查看 <a href="https://git.k8s.io/community/contributors/design-proposals/security-context-constraints.md" target="_blank">Pod 安全策略建议</a> 获取更多信息。</p>

<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#什么是-pod-安全策略">什么是 Pod 安全策略？</a>
<ul>
<li><a href="#runasuser">RunAsUser</a></li>
<li><a href="#selinux">SELinux</a></li>
<li><a href="#supplementalgroups">SupplementalGroups</a></li>
<li><a href="#fsgroup">FSGroup</a></li>
<li><a href="#控制卷">控制卷</a></li>
<li><a href="#主机网络">主机网络</a></li>
<li><a href="#允许的主机路径">允许的主机路径</a></li>
</ul></li>
<li><a href="#许可">许可</a></li>
<li><a href="#创建-pod-安全策略">创建 Pod 安全策略</a></li>
<li><a href="#获取-pod-安全策略列表">获取 Pod 安全策略列表</a></li>
<li><a href="#修改-pod-安全策略">修改 Pod 安全策略</a></li>
<li><a href="#删除-pod-安全策略">删除 Pod 安全策略</a></li>
<li><a href="#启用-pod-安全策略">启用 Pod 安全策略</a></li>
<li><a href="#使用-rbac">使用 RBAC</a></li>
</ul></li>
</ul>
</nav>

<h2 id="什么是-pod-安全策略">什么是 Pod 安全策略？</h2>

<p><em>Pod 安全策略</em> 是集群级别的资源，它能够控制 Pod 运行的行为，以及它具有访问什么的能力。
<code>PodSecurityPolicy</code> 对象定义了一组条件，指示 Pod 必须按系统所能接受的顺序运行。
它们允许管理员控制如下方面：</p>

<table>
<thead>
<tr>
<th>控制面</th>
<th>字段名称</th>
</tr>
</thead>

<tbody>
<tr>
<td>已授权容器的运行</td>
<td><code>privileged</code></td>
</tr>

<tr>
<td>为容器添加默认的一组能力</td>
<td><code>defaultAddCapabilities</code></td>
</tr>

<tr>
<td>为容器去掉某些能力</td>
<td><code>requiredDropCapabilities</code></td>
</tr>

<tr>
<td>容器能够请求添加某些能力</td>
<td><code>allowedCapabilities</code></td>
</tr>

<tr>
<td>控制卷类型的使用</td>
<td><a href="#controlling-volumes"><code>volumes</code></a></td>
</tr>

<tr>
<td>主机网络的使用</td>
<td><a href="#host-network"><code>hostNetwork</code></a></td>
</tr>

<tr>
<td>主机端口的使用</td>
<td><code>hostPorts</code></td>
</tr>

<tr>
<td>主机 PID namespace 的使用</td>
<td><code>hostPID</code></td>
</tr>

<tr>
<td>主机 IPC namespace 的使用</td>
<td><code>hostIPC</code></td>
</tr>

<tr>
<td>主机路径的使用</td>
<td><a href="#allowed-host-paths"><code>allowedHostPaths</code></a></td>
</tr>

<tr>
<td>容器的 SELinux 上下文</td>
<td><a href="#selinux"><code>seLinux</code></a></td>
</tr>

<tr>
<td>用户 ID</td>
<td><a href="#runasuser"><code>runAsUser</code></a></td>
</tr>

<tr>
<td>配置允许的补充组</td>
<td><a href="#supplementalgroups"><code>supplementalGroups</code></a></td>
</tr>

<tr>
<td>分配拥有 Pod 数据卷的 FSGroup</td>
<td><a href="#fsgroup"><code>fsGroup</code></a></td>
</tr>

<tr>
<td>必须使用一个只读的 root 文件系统</td>
<td><code>readOnlyRootFilesystem</code></td>
</tr>
</tbody>
</table>

<p><em>Pod 安全策略</em> 由设置和策略组成，它们能够控制 Pod 访问的安全特征。这些设置分为如下三类：</p>

<ul>
<li>*基于布尔值控制*：这种类型的字段默认为最严格限制的值。</li>
<li>*基于被允许的值集合控制*：这种类型的字段会与这组值进行对比，以确认值被允许。</li>
<li>*基于策略控制*：设置项通过一种策略提供的机制来生成该值，这种机制能够确保指定的值落在被允许的这组值中。</li>
</ul>

<h3 id="runasuser">RunAsUser</h3>

<ul>
<li><em>MustRunAs</em> - 必须配置一个 <code>range</code>。使用该范围内的第一个值作为默认值。验证是否不在配置的该范围内。</li>
<li><em>MustRunAsNonRoot</em> - 要求提交的 Pod 具有非零 <code>runAsUser</code> 值，或在镜像中定义了 <code>USER</code> 环境变量。不提供默认值。</li>
<li><em>RunAsAny</em> - 没有提供默认值。允许指定任何 <code>runAsUser</code> 。</li>
</ul>

<h3 id="selinux">SELinux</h3>

<ul>
<li><em>MustRunAs</em> - 如果没有使用预分配的值，必须配置 <code>seLinuxOptions</code>。默认使用 <code>seLinuxOptions</code>。验证 <code>seLinuxOptions</code>。</li>
<li><em>RunAsAny</em> - 没有提供默认值。允许任意指定的 <code>seLinuxOptions</code> ID。</li>
</ul>

<h3 id="supplementalgroups">SupplementalGroups</h3>

<ul>
<li><em>MustRunAs</em> - 至少需要指定一个范围。默认使用第一个范围的最小值。验证所有范围的值。</li>
<li><em>RunAsAny</em> - 没有提供默认值。允许任意指定的 <code>supplementalGroups</code> ID。</li>
</ul>

<h3 id="fsgroup">FSGroup</h3>

<ul>
<li><em>MustRunAs</em> - 至少需要指定一个范围。默认使用第一个范围的最小值。验证在第一个范围内的第一个 ID。</li>
<li><em>RunAsAny</em> - 没有提供默认值。允许任意指定的 <code>fsGroup</code> ID。</li>
</ul>

<h3 id="控制卷">控制卷</h3>

<p>通过设置 PSP 卷字段，能够控制具体卷类型的使用。当创建一个卷的时候，与该字段相关的已定义卷可以允许设置如下值：</p>

<ol>
<li>azureFile</li>
<li>azureDisk</li>
<li>flocker</li>
<li>flexVolume</li>
<li>hostPath</li>
<li>emptyDir</li>
<li>gcePersistentDisk</li>
<li>awsElasticBlockStore</li>
<li>gitRepo</li>
<li>secret</li>
<li>nfs</li>
<li>iscsi</li>
<li>glusterfs</li>
<li>persistentVolumeClaim</li>
<li>rbd</li>
<li>cinder</li>
<li>cephFS</li>
<li>downwardAPI</li>
<li>fc</li>
<li>configMap</li>
<li>vsphereVolume</li>
<li>quobyte</li>
<li>projected</li>
<li>portworxVolume</li>
<li>scaleIO</li>
<li>storageos</li>
<li>* (allow all volumes)</li>
</ol>

<p>对新的 PSP，推荐允许的卷的最小集合包括：configMap、downwardAPI、emptyDir、persistentVolumeClaim、secret 和 projected。</p>

<h3 id="主机网络">主机网络</h3>

<ul>
<li>*HostPorts*， 默认为 <code>empty</code>。<code>HostPortRange</code> 列表通过 <code>min</code>(包含) and <code>max</code>(包含) 来定义，指定了被允许的主机端口。</li>
</ul>

<h3 id="允许的主机路径">允许的主机路径</h3>

<ul>
<li><em>AllowedHostPaths</em> 是一个被允许的主机路径前缀的白名单。空值表示所有的主机路径都可以使用。</li>
</ul>

<h2 id="许可">许可</h2>

<p>包含 <code>PodSecurityPolicy</code> 的 _许可控制_，允许控制集群资源的创建和修改，基于这些资源在集群范围内被许可的能力。</p>

<p>许可使用如下的方式为 Pod 创建最终的安全上下文：
1. 检索所有可用的 PSP。
1. 生成在请求中没有指定的安全上下文设置的字段值。
1. 基于可用的策略，验证最终的设置。</p>

<p>如果某个策略能够匹配上，该 Pod 就被接受。如果请求与 PSP 不匹配，则 Pod 被拒绝。</p>

<p>Pod 必须基于 PSP 验证每个字段。</p>

<h2 id="创建-pod-安全策略">创建 Pod 安全策略</h2>

<p>下面是一个 Pod 安全策略的例子，所有字段的设置都被允许：</p>



 













<table class="includecode" id="psp-yaml">
    <thead>
        <tr>
            <th>
                <a href="https://github.com/kubernetes/website/blob/master/content/zh/docs/concepts/policy/psp.yaml" download="psp.yaml">
                    <code>psp.yaml docs/concepts/policy</code>
                </a>
                <img src="/images/copycode.svg" style="max-height:24px" onclick="copyCode('psp-yaml')" title="Copy psp.yaml to clipboard">
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>extensions/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>PodSecurityPolicy<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>permissive<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>seLinux:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>rule:<span style="color:#bbb"> </span>RunAsAny<span style="color:#bbb">
</span><span style="color:#bbb">  </span>supplementalGroups:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>rule:<span style="color:#bbb"> </span>RunAsAny<span style="color:#bbb">
</span><span style="color:#bbb">  </span>runAsUser:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>rule:<span style="color:#bbb"> </span>RunAsAny<span style="color:#bbb">
</span><span style="color:#bbb">  </span>fsGroup:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>rule:<span style="color:#bbb"> </span>RunAsAny<span style="color:#bbb">
</span><span style="color:#bbb">  </span>hostPorts:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>min:<span style="color:#bbb"> </span><span style="color:#666">8000</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>max:<span style="color:#bbb"> </span><span style="color:#666">8080</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span><span style="color:#b44">&#39;*&#39;</span><span style="color:#bbb">
</span></code></pre></div>  </td>
        </tr>
    </tbody>
</table>



<p>下载示例文件可以创建该策略，然后执行如下命令：</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl create -f ./psp.yaml
podsecuritypolicy <span style="color:#b44">&#34;permissive&#34;</span> created</code></pre></div>
<h2 id="获取-pod-安全策略列表">获取 Pod 安全策略列表</h2>

<p>获取已存在策略列表，使用 <code>kubectl get</code>：</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get psp
NAME        PRIV   CAPS  SELINUX   RUNASUSER         FSGROUP   SUPGROUP  READONLYROOTFS  VOLUMES
permissive  <span style="color:#a2f">false</span>  <span style="color:#666">[]</span>    RunAsAny  RunAsAny          RunAsAny  RunAsAny  <span style="color:#a2f">false</span>           <span style="color:#666">[</span>*<span style="color:#666">]</span>
privileged  <span style="color:#a2f">true</span>   <span style="color:#666">[]</span>    RunAsAny  RunAsAny          RunAsAny  RunAsAny  <span style="color:#a2f">false</span>           <span style="color:#666">[</span>*<span style="color:#666">]</span>
restricted  <span style="color:#a2f">false</span>  <span style="color:#666">[]</span>    RunAsAny  MustRunAsNonRoot  RunAsAny  RunAsAny  <span style="color:#a2f">false</span>           <span style="color:#666">[</span>emptyDir secret downwardAPI configMap persistentVolumeClaim projected<span style="color:#666">]</span></code></pre></div>
<h2 id="修改-pod-安全策略">修改 Pod 安全策略</h2>

<p>通过交互方式修改策略，使用 <code>kubectl edit</code>：</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl edit psp permissive</code></pre></div>
<p>该命令将打开一个默认文本编辑器，在这里能够修改策略。</p>

<h2 id="删除-pod-安全策略">删除 Pod 安全策略</h2>

<p>一旦不再需要一个策略，很容易通过 <code>kubectl</code> 删除它：</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl delete psp permissive
podsecuritypolicy <span style="color:#b44">&#34;permissive&#34;</span> deleted</code></pre></div>
<h2 id="启用-pod-安全策略">启用 Pod 安全策略</h2>

<p>为了能够在集群中使用 Pod 安全策略，必须确保满足如下条件：</p>

<ol>
<li>已经启用 API 类型 <code>extensions/v1beta1/podsecuritypolicy</code>（仅对 1.6 之前的版本）</li>
<li>已经启用许可控制器 <code>PodSecurityPolicy</code></li>
<li>已经定义了自己的策略</li>
</ol>

<h2 id="使用-rbac">使用 RBAC</h2>

<p>在 Kubernetes 1.5 或更新版本，可以使用 PodSecurityPolicy 来控制，对基于用户角色和组的已授权容器的访问。访问不同的 PodSecurityPolicy 对象，可以基于认证来控制。基于 Deployment、ReplicaSet 等创建的 Pod，限制访问 PodSecurityPolicy 对象，<a href="/docs/admin/kube-controller-manager/">Controller Manager</a> 必须基于安全 API 端口运行，并且不能够具有超级用户权限。</p>

<p>PodSecurityPolicy 认证使用所有可用的策略，包括创建 Pod 的用户，Pod 上指定的服务账户（Service Account）。当 Pod 基于 Deployment、ReplicaSet 创建时，它是创建 Pod 的 Controller Manager，所以如果基于非安全 API 端口运行，允许所有的 PodSecurityPolicy 对象，并且不能够有效地实现细分权限。用户访问给定的 PSP 策略有效，仅当是直接部署 Pod 的情况。更多详情，查看 <a href="https://git.k8s.io/kubernetes/examples/podsecuritypolicy/rbac/README.md" target="_blank">PodSecurityPolicy RBAC 示例</a>，当直接部署 Pod 时，应用 PodSecurityPolicy 控制基于角色和组的已授权容器的访问 。</p>

          
          <div class="social-share" data-initialized="true" data-wechat-qrcode-title="不扫别后悔">
  <center>
    <font style="font-size:18px;color:darkcyan;">分享到：</font>
    <a href="#" class="social-share-icon icon-weibo"></a>
    <a href="#" class="social-share-icon icon-wechat"></a>
    <a href="#" class="social-share-icon icon-twitter"></a>
    <a href="#" class="social-share-icon icon-linkedin"></a>
    <a href="#" class="social-share-icon icon-facebook"></a>
    <a href="#" class="social-share-icon icon-qq"></a>
    <a href="#" class="social-share-icon icon-qzone"></a>
  </center>
</div>


<script src="https://hugo-picture.oss-cn-beijing.aliyuncs.com/social-share.min.js"></script>
          
        </article>
      </div>
    </div>
  </div>
</section>

<footer>
    <main class="light-text">
        <nav>
            
            
            
            <a href="/zh/docs/home/">主页</a>
            
            <a href="/zh/blog/">技术专题</a>
            
            
            
            
            
            <a href="/zh/case-studies/">三维技术专题</a>
            
        </nav>
        <div class="social">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
            <div>
                
                <a href="https://git.k8s.io/community/contributors/guide" class="button">贡献</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2019 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a></a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2019 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
        <div id="miceType" class="center">
            ICP license: 京ICP备17074266号-3
        </div>
    </main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<script>

(function () {
    window.addEventListener('DOMContentLoaded', init)

        
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>



<script language="application/javascript">
  
  (function addHeadingLinks(){
    var article = document.getElementById('docsContent');
    var headings = article.querySelectorAll('h1, h2, h3, h4, h5, h6');
    headings.forEach(function(heading){
      if(heading.id){
        var a = document.createElement('a');
        a.innerHTML = heading.innerHTML;
        a.href = '#'+heading.id;
        a.classList.add('inpage_heading');
        heading.innerHTML = '';
        heading.appendChild(a);
      }
    });
  })();
</script>
</body>
</html>